<map version="1.0.1">
<!-- To view this file, download free mind mapping software FreeMind from http://freemind.sourceforge.net -->
<node CREATED="1472694016229" ID="ID_1380030112" MODIFIED="1473237167580" TEXT="&#x652f;&#x4ed8;&#x7ec4;">
<richcontent TYPE="NOTE"><html>
  <head>
    
  </head>
  <body>
    <p>
      
    </p>
    <p type="text/css">
      com.tuan.notifyserver
    </p>
    <p>
      
    </p>
    <p>
      CTRL+G&#21487;&#20197;&#25628;&#32034;&#19979;&#19968;&#20010;&#21305;&#37197;&#39033;&#12290;&#65288;CTRL+F&#65289;&#30340;&#21518;&#32493;
    </p>
    <p>
      
    </p>
    <p>
      <font color="#009933">&#26412;&#39033;&#30446;&#20013;&#32467;&#26500;&#65292;&#22810;&#37319;&#29992;interface + abstract + realimpl&#30340;&#26550;&#26500; </font>
    </p>
    <p>
      
    </p>
    <p>
      <font color="#009933">&#21363;interface&#23450;&#20041;&#25509;&#21475; </font>
    </p>
    <p>
      
    </p>
    <p>
      <font color="#009933">abstract&#23450;&#20041;&#19994;&#21153;&#27969;&#31243;&#65292;&#24182;&#30041;&#19979;&#33509;&#24178;&#20851;&#38190;&#30340;abstract&#26680;&#24515;&#22788;&#29702;&#20379;realimpl&#21435;&#32487;&#25215;&#24182;&#23454;&#29616;&#12290;&#160;</font><font color="#006633">&#160;</font>
    </p>
    <p>
      
    </p>
    <p>
      &#28857;&#20987;&#32418;&#33394;&#38142;&#25509;&#21551;&#21160;&#24037;&#20855;&#29992;&#26469;&#30699;&#27491;&#65292;&#26041;&#24335;&#24456;&#31616;&#21333;&#65292;&#23558;&#20081;&#30721;&#25335;&#36125;&#36827;&#36755;&#20837;&#26694;&#65292;&#28857;&#20987;&#22788;&#29702;&#25353;&#38062;&#65292;&#19979;&#26041;&#27983;&#35272;&#22120;&#21487;&#30475;&#21040;&#27491;&#24120;&#20869;&#23481;&#65292;&#25335;&#36125;&#22238;&#26469;&#21363;&#21487;&#12290;
    </p>
    <p>
      
    </p>
    <p>
      &#30830;&#23450;&#20102;&quot;&#38271;&#33410;&#28857;&quot;&#21487;&#20197;&#26367;&#20195;&#22791;&#27880;&#65292;&#20294;&#29992;&#38271;&#33410;&#28857;&#21069;&#65292;&#35831;&#21153;&#24517;&#36755;&#20837;&#36739;&#23569;&#23383;&#31526;&#65292;&#20445;&#23384;&#21518;&#65292;&#28982;&#21518;&#20877;&#28857;&#24320;&#8220;&#38271;&#33410;&#28857;&quot;&#25165;&#33021;&#36827;&#34892;html&#31561;&#39068;&#33394;&#26631;&#27880;
    </p>
    <p>
      
    </p>
    <p>
      <font color="#ff0000">&#25214;&#21040;&#21407;&#22240;&#20102;&#65306;&#22791;&#27880;&#25110;&#32773;&#21482;&#35201;&#29992;&#21040;&#20102;html&#30340;&#22320;&#26041;&#19968;&#23450;&#19981;&#35201;&#29992;&#33521;&#25991;&#24341;&#21495;&#65292;&#20882;&#21495;&#31561;&#29305;&#27530;&#23383;&#31526;&#21543;&#65292;&#21542;&#21017;&#24517;&#23450;&#20081;&#30721;&#20102;&#12290;</font>
    </p>
  </body>
</html></richcontent>
<node CREATED="1472694078828" ID="ID_101371554" MODIFIED="1472694082632" POSITION="left" TEXT="mdtask">
<node CREATED="1473066573935" ID="ID_175032134" MODIFIED="1473066580789" TEXT="&#x6570;&#x636e;&#x5e93;&#x5904;&#x7406;&#x6a21;&#x5f0f;"/>
</node>
<node BACKGROUND_COLOR="#66ff66" CREATED="1473734185522" FOLDED="true" ID="ID_47046362" MODIFIED="1476064889439" POSITION="right" TEXT="&#x65b9;&#x5f0f;&#x65b9;&#x6cd5;">
<icon BUILTIN="messagebox_warning"/>
<node CREATED="1473734197680" ID="ID_17049138" MODIFIED="1473734248675">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      1&#12289;&#29992;onenote&#25490;&#29256;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1473734207893" ID="ID_135312101" MODIFIED="1473734332225">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      2&#12289;&#29992;&#21360;&#35937;&#31508;&#35760;&#36716;&#25442;&#20026;&#22270;&#29255;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1473734222456" ID="ID_1534577137" MODIFIED="1473734262802">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      3&#12289;&#29992;freemind&#32452;&#32455;&#26550;&#26500;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1472694040313" FOLDED="true" ID="ID_589861280" MODIFIED="1475030205856" POSITION="right" TEXT="mdpaygate">
<node CREATED="1473066573935" ID="ID_1020199487" MODIFIED="1473066580789" TEXT="&#x6570;&#x636e;&#x5e93;&#x5904;&#x7406;&#x6a21;&#x5f0f;"/>
<node BACKGROUND_COLOR="#99ff99" CREATED="1473299914657" ID="ID_1223111739" MODIFIED="1475029831030">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      service
    </p>
  </body>
</html></richcontent>
<node CREATED="1473299929166" ID="ID_1873389800" MODIFIED="1473643038780">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      impl
    </p>
    <p>
      &#25509;&#21475;&#23454;&#29616;
    </p>
  </body>
</html></richcontent>
<node CREATED="1473299934571" ID="ID_35179078" MODIFIED="1473299974236" TEXT="TradeServiceImpl">
<node CREATED="1473299948374" ID="ID_403457848" MODIFIED="1473299959058" TEXT="createMobileParams"/>
<node CREATED="1473299975710" ID="ID_1852803542" MODIFIED="1473299983608" TEXT="createTradeNo"/>
</node>
</node>
<node CREATED="1473643015840" FOLDED="true" ID="ID_427646929" MODIFIED="1475030199839" TEXT="&#x63a5;&#x53e3;&#x5b9a;&#x4e49;">
<node BACKGROUND_COLOR="#ffff99" CREATED="1473643411006" ID="ID_906423994" MODIFIED="1475029831071">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      TradeService
    </p>
    <p>
      
    </p>
    <ul>
      <li>
        &#21019;&#24314;&#31532;&#19977;&#26041;&#25903;&#20184;&#30340;&#25903;&#20184;&#35831;&#27714;
      </li>
      <li>
        &#25509;&#25910;&#31532;&#19977;&#26041;&#25903;&#20184;&#30340;&#36890;&#30693;&#25509;&#21475;
      </li>
      <li>
        &#31532;&#19977;&#26041;&#25903;&#20184;&#30340;&#26597;&#35810;&#25509;&#21475;
      </li>
    </ul>
  </body>
</html></richcontent>
<node BACKGROUND_COLOR="#ffff99" CREATED="1473643421631" ID="ID_1470068820" MODIFIED="1473644271534" TEXT="createMobileParams">
<node CREATED="1473643500524" ID="ID_1305735498" MODIFIED="1473643505829" TEXT="&#x5b9a;&#x4e49;">
<node CREATED="1473643510006" ID="ID_424745433" MODIFIED="1473643539972">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      public <font color="#0033cc">CallResult&lt;Map&lt;String,String&gt;&gt;</font>&#160; createMobileParams(<font color="#660066">TradeVO</font>&#160;tradeVO, String secret);
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffff99" CREATED="1473643580317" ID="ID_1495652446" MODIFIED="1473644330582" TEXT="tradePayNotify">
<node CREATED="1473643591100" ID="ID_1072954253" MODIFIED="1473643596246" TEXT="&#x5b9a;&#x4e49;">
<node CREATED="1473643601016" ID="ID_1062166413" MODIFIED="1473643665012">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      public <font color="#0033cc">CallResult&lt;TradeNotifyResult&gt; </font>tradePayNotify(
    </p>
    <p>
      <font color="#cc0000">PayTypeEnum</font>&#160;bankTypeEnum, Map&lt;String, String&gt; <font color="#006666">requestParams</font>,String requestUrl,
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;String ip,int notifyStatus) throws TuanRuntimeException;
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node CREATED="1473644201706" ID="ID_185322944" MODIFIED="1473644342003">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b><font color="#0033cc">processWeiFuTongScanPayResult</font></b>
    </p>
  </body>
</html></richcontent>
<node CREATED="1473644235494" ID="ID_636103439" MODIFIED="1473644238990" TEXT="&#x5b9a;&#x4e49;">
<node CREATED="1473644240600" ID="ID_1756978548" MODIFIED="1473644252883">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      public void processWeiFuTongScanPayResult(String commonScanPayResultString, String ip , String inputTradeNo);
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffff99" CREATED="1473643939673" ID="ID_594689279" MODIFIED="1473644282560" TEXT="closeTrade">
<node CREATED="1473643988340" ID="ID_1041891062" MODIFIED="1473643992519" TEXT="&#x5b9a;&#x4e49;">
<node CREATED="1473644007129" ID="ID_1740293524" MODIFIED="1473644036508">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      public <font color="#0033cc">CallResult&lt;String&gt;</font>&#160;closeTrade(String <font color="#ff3300">tradeId</font>,int businessType,String secret);
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node CREATED="1473644111708" ID="ID_256557926" MODIFIED="1473644128549" TEXT="...&#x5176;&#x4ed6;">
<node CREATED="1473644130284" ID="ID_670333040" MODIFIED="1473644178436">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      tradePayQueryBy<font color="#cc0000">TradeNo</font>
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1473644158191" ID="ID_1869483276" MODIFIED="1473644187586">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      tradePayQueryBy<font color="#0033cc">TradeId</font>
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
<node CREATED="1473643212402" FOLDED="true" ID="ID_1277502724" MODIFIED="1475030202663" TEXT="spring bean xml&#x914d;&#x7f6e;">
<node CREATED="1473643225824" ID="ID_73378328" MODIFIED="1475029831084" TEXT="mdpaygate-dubbo.xml">
<node CREATED="1473643271319" ID="ID_1453519399" MODIFIED="1473643372705">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
    </p>
    <p>
      &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
    </p>
    <p>
      xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:dubbo=&quot;http://code.alibabatech.com/schema/dubbo&quot;
    </p>
    <p>
      xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
    </p>
    <p>
      http://www.springframework.org/schema/beans/spring-beans.xsd
    </p>
    <p>
      http://code.alibabatech.com/schema/dubbo&#160;&#160;&#160;&#160;&#160;&#160;&#160;
    </p>
    <p>
      http://code.alibabatech.com/schema/dubbo/dubbo.xsd&quot;
    </p>
    <p>
      default-autowire=&quot;byName&quot;&gt;
    </p>
    <p>
      
    </p>
    <p>
      &lt;!-- &#25903;&#20184;&#25509;&#21475; --&gt;
    </p>
    <p>
      &lt;dubbo:reference id=&quot;<b><font color="#660066">tradeService</font></b>&quot;
    </p>
    <p>
      interface=&quot;<font color="#006666">com.wowo.mdpaygate.service.</font><font color="#660066">TradeService</font>&quot; check=&quot;false&quot;
    </p>
    <p>
      version=&quot;1.0&quot; /&gt;
    </p>
    <p>
      
    </p>
    <p>
      &lt;!-- &#36864;&#27454;&#25509;&#21475; --&gt;
    </p>
    <p>
      &lt;dubbo:reference id=&quot;<b><font color="#006600">refundService</font></b>&quot;
    </p>
    <p>
      interface=&quot;<font color="#006666">com.wowo.mdpaygate.service.</font><font color="#006600">RefundService</font>&quot; check=&quot;false&quot;
    </p>
    <p>
      version=&quot;1.0&quot; /&gt;
    </p>
    <p>
      
    </p>
    <p>
      &lt;/beans&gt;
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
<node CREATED="1473642746001" ID="ID_1950575455" MODIFIED="1473642829429" TEXT="&#x8d1f;&#x8d23;">
<node CREATED="1473642831154" ID="ID_104838692" MODIFIED="1473642837394" TEXT="&#x8ba2;&#x5355;&#x53c2;&#x6570;&#x7684;&#x751f;&#x6210;"/>
<node CREATED="1473642838677" ID="ID_1962340266" MODIFIED="1473642847359" TEXT="&#x8ba2;&#x5355;&#x72b6;&#x6001;&#x7684;&#x66f4;&#x65b0;"/>
</node>
</node>
<node CREATED="1472694032236" ID="ID_1260912116" MODIFIED="1472694038152" POSITION="left" TEXT="mdfrontserver">
<node CREATED="1473066573935" ID="ID_1036565298" MODIFIED="1473066580789" TEXT="&#x6570;&#x636e;&#x5e93;&#x5904;&#x7406;&#x6a21;&#x5f0f;"/>
</node>
<node CREATED="1472694045163" ID="ID_1130587513" MODIFIED="1472694053721" POSITION="left" TEXT="mdtradecenter">
<node CREATED="1473066573935" ID="ID_493780406" MODIFIED="1473066580789" TEXT="&#x6570;&#x636e;&#x5e93;&#x5904;&#x7406;&#x6a21;&#x5f0f;"/>
</node>
<node CREATED="1473237168608" ID="ID_29738871" MODIFIED="1475030743923" POSITION="right" TEXT="&#x652f;&#x4ed8;&#x6d41;&#x7a0b;">
<node CREATED="1473835794197" FOLDED="true" ID="ID_269882459" MODIFIED="1476064903926" TEXT="5&#x6b65;">
<node CREATED="1473237176756" ID="ID_344807398" MODIFIED="1473835815590">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      1&#12289;<font color="#009933">newwap</font>-&gt;<font color="#660066">frontserver</font>&#65288;&#21019;&#24314;&#35746;&#21333;&#21495;&#65289;-&gt;<font color="#006633">tradecenter</font>&#65288;&#29983;&#25104;&#35746;&#21333;&#24182;&#20889;&#20837;&#25968;&#25454;&#24211;&#65289;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1473237297826" ID="ID_152306061" MODIFIED="1473835817877">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      2&#12289;tradecenter&#29983;&#25104;&#35746;&#21333;&#25104;&#21151;&#21518;&#65292;&#36820;&#22238;fronserver
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;frontserver&#32487;&#32493;&#35843;&#29992;paygate&#29983;&#25104;&#25509;&#21475;&#25152;&#38656;&#30340;&#25903;&#20184;&#21442;&#25968;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1473237388008" ID="ID_1361393808" MODIFIED="1473835819955">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      3&#12289;frontserver&#25226;&#25903;&#20184;&#21442;&#25968;&#36890;&#36807;newwap&#36820;&#32473;&#23458;&#25143;&#31471;&#29992;&#20110;&#23458;&#25143;&#31471;&#23436;&#25104;&#25903;&#20184;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1473237441231" ID="ID_1879423323" MODIFIED="1473835821403">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      4&#12289;&#23458;&#25143;&#31471;&#25903;&#20184;&#30340;&#31532;&#19977;&#26041;&#25509;&#21475;&#20250;&#36890;&#36807;&#22238;&#35843;paygate&#25509;&#21475;&#36890;&#30693;&#25903;&#20184;&#25104;&#21151;&#24182;&#23436;&#25104;&#21518;&#32493;&#29366;&#24577;&#21047;&#26032;
    </p>
  </body>
</html></richcontent>
<node CREATED="1473321350215" ID="ID_465633433" MODIFIED="1473321364308" TEXT="&#x641c;&#x7d22;AbstractNotify"/>
</node>
<node CREATED="1473321382573" ID="ID_1176765549" MODIFIED="1473321402774" TEXT="5&#x3001;paygate&#x8c03;&#x7528;frontserver&#x6765;&#x5b8c;&#x6210;&#x8ba2;&#x5355;&#x72b6;&#x6001;&#x66f4;&#x65b0;">
<node CREATED="1473321404676" ID="ID_848742019" MODIFIED="1473321412252" TEXT="paycallback.do"/>
</node>
</node>
<node CREATED="1473835826658" FOLDED="true" ID="ID_777148863" MODIFIED="1476069278567" TEXT="&#x8be6;&#x7ec6;&#x8bf4;&#x660e;">
<node CREATED="1473835858709" ID="ID_1214891478" MODIFIED="1476068116544">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      mdfrontserver : com.wowo.<b><font color="#660066">mdfrontserver</font></b>.<font color="#000099">web</font><font color="#cc0000">.controller.trade.</font><font color="#336600">ShOrderController</font>
    </p>
  </body>
</html></richcontent>
<node CREATED="1473836197463" ID="ID_1724087648" MODIFIED="1473836202839" TEXT="/create.do">
<node CREATED="1473836217238" ID="ID_913017427" MODIFIED="1473836309822">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      return&#160;&#160;shOrderServiceAdapter.<font color="#000099">createShOrder</font>(<font color="#660066">orderParamModel</font>)
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1473836205316" ID="ID_1220567706" MODIFIED="1473836211662" TEXT="/wftcreate.do"/>
</node>
<node CREATED="1473836610870" FOLDED="true" ID="ID_174701000" MODIFIED="1476068160709">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#21442;&#25968;&#30340;&#37096;&#20998;&#37325;&#35201;&#23646;&#24615;&#35828;&#26126;
    </p>
  </body>
</html></richcontent>
<node CREATED="1473836621753" ID="ID_826244738" MODIFIED="1476068157936" TEXT="ShOrderCreateParam">
<node CREATED="1473837155000" FOLDED="true" ID="ID_671134209" MODIFIED="1476066328084" TEXT="payType ">
<node CREATED="1473837168036" ID="ID_1138412187" MODIFIED="1473837182121" TEXT="0 , &#x4e0d;&#x7528;&#x7b2c;&#x4e09;&#x65b9;&#x652f;&#x4ed8;"/>
<node CREATED="1473837183953" ID="ID_1027042987" MODIFIED="1473837195416" TEXT="1&#xff0c;&#x652f;&#x4ed8;&#x5b9d;&#x7f51;&#x9875;&#x652f;&#x4ed8;"/>
<node CREATED="1473837197145" ID="ID_1197850042" MODIFIED="1473837203778" TEXT="2&#xff0c;&#x652f;&#x4ed8;&#x5b9d;&#x94b1;&#x5305;&#x652f;&#x4ed8;"/>
<node CREATED="1473837205008" ID="ID_966259890" MODIFIED="1473837215864" TEXT="3&#xff0c;&#x652f;&#x4ed8;&#x5b9d;&#x4e00;&#x952e;&#x652f;&#x4ed8;"/>
<node CREATED="1473837217613" ID="ID_1181061830" MODIFIED="1473837227698" TEXT="4&#xff0c;&#x8d22;&#x4ed8;&#x901a;&#x7f51;&#x9875;&#x652f;&#x4ed8;"/>
<node CREATED="1473837228718" ID="ID_518100470" MODIFIED="1473837264680">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      6&#65292;&#24494;&#20449;&#23458;&#25143;&#31471;&#25903;&#20184;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1473837240964" ID="ID_1735438329" MODIFIED="1473837258184" TEXT="7 &#x652f;&#x4ed8;&#x5b9d;&#x65b0;&#x7248;&#x6536;&#x94f6;&#x53f0;"/>
<node CREATED="1474440943321" ID="ID_505455569" MODIFIED="1474440991641" TEXT="8 &#x5fae;&#x4fe1;&#x626b;&#x7801;&#x652f;&#x4ed8;"/>
<node CREATED="1474440974687" ID="ID_182807257" MODIFIED="1474440994733" TEXT="9 &#x5a01;&#x5bcc;&#x901a;&#x652f;&#x4ed8;"/>
<node CREATED="1474440896074" ID="ID_214860495" MODIFIED="1474440996775" TEXT="11 &#x597d;&#x9002;&#x53e3;"/>
<node CREATED="1474440872481" ID="ID_804357656" MODIFIED="1474440891011" TEXT="12 &#x5a01;&#x5bcc;&#x901a;&#x5c0f;&#x989d;&#x652f;&#x4ed8;"/>
<node CREATED="1474440915674" ID="ID_690782996" MODIFIED="1474440929899" TEXT="106 &#x652f;&#x4ed8;&#x5b9d;&#x670d;&#x52a1;&#x7a97;"/>
</node>
<node CREATED="1473837274248" ID="ID_452692607" MODIFIED="1473837296766" TEXT="orderId&#xff0c;&#x4ece;newwap&#x4f20;&#x8fc7;&#x6765;&#x7684;&#x5e94;&#x8be5;&#x4e3a;&#x7a7a;&#x5427;"/>
</node>
</node>
</node>
<node CREATED="1476067211508" FOLDED="true" ID="ID_1054888844" MODIFIED="1476780802133" TEXT="2016.10.10 restart...">
<font BOLD="true" NAME="&#x5fae;&#x8f6f;&#x96c5;&#x9ed1;" SIZE="15"/>
<node CREATED="1476067229031" FOLDED="true" ID="ID_611800187" MODIFIED="1476780800151">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      mdfrontserver
    </p>
    <p>
      
    </p>
    <p>
      com.wowo.mdfrontserver.web.controller<font color="#006633">.trade</font>.<font color="#006666">shOrderController</font>
    </p>
    <p>
      &#26159;&#20837;&#21475;&#28857;&#65292;&#23545;&#24212;url:<font color="#660099">/wftcreate.do</font>&#12290;
    </p>
    <p>
      
    </p>
    <p>
      &#23454;&#38469;&#31616;&#21333;&#35843;&#29992;:<font color="#006666">shOrderServiceAdapter.wftCreateShOrder(orderParamModel : ShOrderCreateParam)</font>
    </p>
  </body>
</html></richcontent>
<node CREATED="1476068195636" ID="ID_230310000" MODIFIED="1476068230092" TEXT="String orderId = shOrderCreateParam.getOrderId()"/>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1476068741162" ID="ID_1697838193" MODIFIED="1476068936868" TEXT="initPayCode()"/>
<node CREATED="1476068772941" ID="ID_562459350" MODIFIED="1476068855777">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      orderGenerateService.<font color="#006666">createOrder</font>(<font color="#660099">getCreateParam</font>(shOrderCreateParam))
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1476068967483" ID="ID_625081846" MODIFIED="1476069081025">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      orderFsService.<font color="#009999">wftPayOrder</font>(<font color="#660099">getPayParam</font>(result.orderId))
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1476069097660" ID="ID_817512710" MODIFIED="1476069137225">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      return <font color="#006666">getAdapterResultFromSuccess</font>(payOrderResult)
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ffffcc" CREATED="1476069204359" ID="ID_1665307384" MODIFIED="1476069266428" TEXT="&#x5176;&#x4f59;&#x7684;&#x7528;&#x4e4b;&#x524d;&#x7684;&#x6574;&#x7406;&#x53ef;&#x7528;ctrl+f&#x6765;&#x67e5;">
<node CREATED="1473836256883" FOLDED="true" ID="ID_289967887" MODIFIED="1476780798319">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      return shOrderServiceAdapter<font color="#000099">.<b>wft</b>CreateShOrder</font>(<font color="#660066">orderParamModel</font>)
    </p>
  </body>
</html></richcontent>
<node CREATED="1473836518637" ID="ID_643337987" MODIFIED="1473837789479">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b><font color="#336600">1&#12289;</font></b>shOrderCreateParam.getOrderId()
    </p>
  </body>
</html></richcontent>
<node CREATED="1474269737855" ID="ID_1680834285" MODIFIED="1474269757027" TEXT="&#x63d0;&#x53d6;&#x5c5e;&#x6027;&#x503c;&#x800c;&#x5df2;&#xff0c;&#x4e00;&#x822c;&#x6b64;&#x65f6;&#x4e3a;&#x7a7a;&#x5566;"/>
</node>
<node CREATED="1473837792616" ID="ID_348144110" MODIFIED="1474269947667">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b><font color="#336600">2&#12289;</font></b>initPayCode&#65292;&#27979;&#35797;<font color="#009900">RedisSentinelPool</font>&#20013;key&#20026;paycode&#30340;jedisPool&#26159;&#21542;&#26377;&#21487;&#29992;&#36830;&#25509;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1473837960413" ID="ID_1038592772" MODIFIED="1474269923595">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b><font color="#336600">3&#12289;</font></b><font color="#000000">&#36890;&#36807;</font><font color="#000099">getCreateParam</font><font color="#000000">(shOrderCreateParam)</font>&#25552;&#21462;orderParamModel&#21442;&#25968;&#21040;OrderGenerateParam&#20013;&#65292;&#27492;&#26102;&#32943;&#23450;&#27809;&#26377;orderId&#20540;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1473838052473" FOLDED="true" ID="ID_1358979736" MODIFIED="1476754192485">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b><font color="#336600">4&#12289;</font></b>orderGenerateService.createOrder(orderGenerateParam)&#26469;&#21019;&#24314;&#35746;&#21333;
    </p>
    <p>
      
    </p>
    <p>
      <font color="#336600">&#23601;&#26159;&#22312;md_order_info,md_order_action&#34920;&#25554;&#20837;&#30456;&#20851;&#26032;&#35760;&#24405;</font>
    </p>
    <p>
      
    </p>
    <p>
      <font color="#cc0000"><b>&#21019;&#24314;&#35746;&#21333;&#33509;&#22833;&#36133;&#65292;&#21017;&#36864;&#20986;</b></font>
    </p>
  </body>
</html></richcontent>
<node CREATED="1474270103625" ID="ID_797375467" MODIFIED="1476238282922" TEXT="OrderGenerateServiceImpl">
<node CREATED="1473839398965" ID="ID_453502703" MODIFIED="1476237009290">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      createOrder
    </p>
  </body>
</html></richcontent>
<node CREATED="1474270150134" FOLDED="true" ID="ID_1985972573" MODIFIED="1476344475319">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      0&#12289;final <font color="#000099">OrderGenerateDomain</font>&#160;<font color="#009900">domain</font>&#160;= new OrderGenerateDomain()
    </p>
  </body>
</html></richcontent>
<node CREATED="1474270220328" ID="ID_147214584" MODIFIED="1474270256013" TEXT="1&#x3001;domain.setOrderGenerateParam(orderGenerateParam)"/>
<node CREATED="1474270258028" ID="ID_1509828585" MODIFIED="1474270291675">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      2&#12289;domain.setOrderCreateExtService(<font color="#990099">orderCreateExtService</font>)
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1474270295633" ID="ID_341601780" MODIFIED="1474270343420">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      3&#12289;domain.setOrderRefreshDomainRepository(<font color="#990099">orderRefereshDominRepository</font>)
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1474270370176" FOLDED="true" ID="ID_170003178" MODIFIED="1476344613946">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      1&#12289;<font color="#990099">mdServiceTemplate</font>.<font color="#660000">exeWithoutDB</font>(new <font color="#990099">TemplateAction</font>&lt;<font color="#000099">OrderBindBasicModel</font>&gt;(){checkParam;doAction;checkBiz;}
    </p>
  </body>
</html></richcontent>
<node CREATED="1473839437040" ID="ID_1671916757" MODIFIED="1474270543523">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      1&#12289;checkParam -&gt; <font color="#009900">domain</font>.checkParam
    </p>
  </body>
</html></richcontent>
<node CREATED="1473839443156" ID="ID_1099434969" MODIFIED="1473839503129" TEXT="shopId,orderChannel,billAmount,devicestr&#x4e0d;&#x80fd;&#x4e3a;&#x7a7a;"/>
</node>
<node CREATED="1473839537274" ID="ID_505777804" MODIFIED="1476069325077">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      2&#12289;doAction -&gt; <font color="#009900">domain</font>.generateOrder()
    </p>
  </body>
</html></richcontent>
<node CREATED="1473839771206" ID="ID_30206415" MODIFIED="1474357859113">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      1&#12289;checkShop
    </p>
    <p>
      
    </p>
    <p>
      <font color="#cc0000">&#21462;&#19981;&#21040;ShopForQuery&#21017;&#36864;&#20986;</font>
    </p>
  </body>
</html></richcontent>
<node CREATED="1473839809420" FOLDED="true" ID="ID_1289375909" MODIFIED="1476344014638">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      1&#12289;CallResult&lt;<font color="#336600">ShopForQuery</font>&gt; result = orderCreateExtService.GetShopByIdWithRebateNow(shopId)
    </p>
    <p>
      <b><font color="#000099">&#25552;&#21462;&#38376;&#24215;&#36820;&#29616;&#26041;&#26696;</font></b>
    </p>
  </body>
</html></richcontent>
<node CREATED="1473839875949" ID="ID_9736253" MODIFIED="1473839948274">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#003333">shopServic</font>e<b><font color="#ff0000">Dubbo</font></b>.getShopByIdWithRebateNow(shopId)
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1476238309963" ID="ID_787929270" MODIFIED="1476238320531" TEXT="&#x8fd4;&#x56de;&#x8282;&#x70b9;">
<node CREATED="1476238290097" ID="ID_1589802964" LINK="#ID_1720308229" MODIFIED="1476238335426" TEXT="&#x8fd4;&#x56de;wftPay&#x8282;&#x70b9;"/>
</node>
</node>
<node CREATED="1473840028385" ID="ID_1447184236" MODIFIED="1473840045635" TEXT="2&#x3001;result == null &#x5219;&#x62a5;&#x9519;"/>
<node CREATED="1473840060868" ID="ID_1451686571" MODIFIED="1473840156641">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      3&#12289;&#21542;&#21017;&#65292;<font color="#336600">ShopForQuery</font>&#160;ShopRebateDTO = result.getResultObject();
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1473840703072" ID="ID_1072251947" MODIFIED="1476069338280">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      2&#12289;orderCreateExtService.getOrderId()&#65292;&#33719;&#21462;&#35746;&#21333;&#21495;
    </p>
    <p>
      
    </p>
    <p>
      <b><font color="#ff3333">&#33719;&#21462;&#35746;&#21333;&#20026;&#31354;&#21017;&#36864;&#20986;</font></b>
    </p>
  </body>
</html></richcontent>
<node CREATED="1473840762489" FOLDED="true" ID="ID_1669329778" MODIFIED="1476069406975" TEXT="payService.generateOrderId(&quot;Z&quot;);">
<node CREATED="1473840986209" ID="ID_1781980063" MODIFIED="1473841029451" TEXT="1&#x3001;OrderIdGenerateHandler handler = handleMap.get(&quot;Z&quot;);">
<node CREATED="1473841039486" ID="ID_1573244083" MODIFIED="1473841067229" TEXT="Map&lt;String,OrderGenerateHandler&gt; handleMap"/>
</node>
<node CREATED="1473841090098" ID="ID_1971853675" MODIFIED="1476069355130" TEXT="2&#x3001;if  handler = null">
<node CREATED="1473841100435" FOLDED="true" ID="ID_463630146" MODIFIED="1476069404382">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#ff3333">handler</font>&#160;= new OrderIdGenerateHandler();
    </p>
  </body>
</html></richcontent>
<node CREATED="1473842025840" ID="ID_626703114" MODIFIED="1473842078370">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      RedisCache <b><font color="#660066">redisCache </font></b>= RedisCacheFactory.get<font color="#000099">PayCode</font>RedisCache():
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1473841848732" ID="ID_1137477335" MODIFIED="1473841905465">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#23454;&#29616;&#20102;<b><font color="#336600">run&#26041;&#27861;</font></b>
    </p>
  </body>
</html></richcontent>
<node CREATED="1473841981267" ID="ID_295406210" MODIFIED="1473841998516" TEXT="while(true)">
<node CREATED="1473842000034" ID="ID_353609463" MODIFIED="1473842649807" TEXT="1&#x3001;String dateStr  = getKeyDate();&#x83b7;&#x53d6;20160914"/>
<node CREATED="1473842652372" ID="ID_1645080614" MODIFIED="1473842919355">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      2&#12289;&#32452;&#35013; String <b><font color="#000099">key </font></b>= &quot;ORDER_ID_GENERATE_KEY_PREFIX&quot;+&quot;20160914&quot;;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1473842711643" ID="ID_1589411562" MODIFIED="1474270937617">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      3&#12289;redisCache.setnx(<font color="#000099">key</font>,<font color="#ff0000">1000+&quot;&quot;</font>)
    </p>
    <p>
      
    </p>
    <p>
      &#21482;&#26159;&#35774;&#32622;orderid&#30340;&#36215;&#22987;&#20540;&#20026;1000
    </p>
  </body>
</html></richcontent>
<node CREATED="1473842751218" ID="ID_548761490" MODIFIED="1473843014779">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#22914;&#26524;&#35774;&#32622;&#25104;&#21151;&#65288;&#19981;&#23384;&#22312;&#27492;key)&#65292;&#21017;&#65306;
    </p>
    <p>
      &#39069;&#22806;&#20877;&#35774;&#32622;<font color="#336600">28&#23567;&#26102;</font>&#36807;&#26399;&#26102;&#38388;&#65292;redisCache.setex(<font color="#000099">key</font>,<b><font color="#006600">100800</font></b>,<font color="#ff0000">1000+&quot;&quot;</font>)
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1473843026207" ID="ID_1810999961" MODIFIED="1473843443715">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      4&#12289;redis.incrby(<font color="#000099">key</font>,100);
    </p>
  </body>
</html></richcontent>
<node CREATED="1473843533264" ID="ID_1120585427" MODIFIED="1473843901028">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#22914;&#26524;&#22686;&#21152;&#25104;&#21151;(&#31532;&#19968;&#27425;&#65292;&#21017;&#21464;&#20026;1100)&#65292;&#21017;
    </p>
    <p>
      long begin = <font color="#ff0000">1100</font>&#160;- 100;
    </p>
    <p>
      for(long orderId = begin;begin&lt;1100;orderId++)
    </p>
    <p>
      
    </p>
    <p>
      String <b><font color="#660066">orderIdK</font></b>&#160;= <b><font color="#000099">dateStr + orderId</font></b>,&#27604;&#22914;&#65306;<font color="#000099">20160914</font><font color="#ff0000">1000</font>
    </p>
    <p>
      queue.put(<b><font color="#660066">orderIdK</font></b>) <b><font color="#660066">// put&#21040;&#23481;&#37327;200&#26102;&#65292;&#35302;&#21457;</font><font color="#ff3333">&#32447;&#31243;</font><font color="#660066">&#38459;&#26029;&#31561;&#24453;...</font></b>
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
</node>
<node CREATED="1473841116632" ID="ID_808140620" MODIFIED="1473841134811" TEXT="handleMap.put(&quot;Z&quot;,handler);"/>
<node CREATED="1473841163040" ID="ID_394630712" MODIFIED="1473841219305">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Thread <b><font color="#000099">t</font></b>&#160;= new Thread(<font color="#ff3333">handler</font>);<font color="#000099">t.start()</font>;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1473841225929" ID="ID_1032977414" MODIFIED="1473841888187">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      3&#12289;return &quot;Z&quot;+<b><font color="#ff0000">handler</font><font color="#000099">.take()</font></b>;
    </p>
  </body>
</html></richcontent>
<node CREATED="1473841425332" FOLDED="true" ID="ID_915675449" MODIFIED="1475030985918" TEXT="1&#x3001;String date = getKeyDate();">
<node CREATED="1473841472038" ID="ID_1545844564" MODIFIED="1473841553378">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      Date date = new Date(System.currentTimeMillis());
    </p>
    <p>
      SimpleDateFormat sdf = new SimpleDateFormat(&quot;YYMMdd&quot;);
    </p>
    <p>
      String dateS = sdf.format(date);
    </p>
    <p>
      return dateS
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1473841585684" ID="ID_1095942474" MODIFIED="1473841740474">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      2&#12289;while(<font color="#ff0000">true</font>)
    </p>
    <p>
      &#20174;<b><font color="#336600">queue.take()&#19968;</font></b>&#30452;&#21040;&#21462;&#21040;orderId.<font color="#000099">startsWith(date)</font>&#25104;&#31435;&#30340;&#35746;&#21333;id&#20026;&#27490;&#25165;&#36339;&#20986;
    </p>
  </body>
</html></richcontent>
<node CREATED="1473841756739" ID="ID_1137885937" MODIFIED="1473841829290">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      ArrayBlockingQueue&lt;String&gt; queue
    </p>
    <p>
      &#160;= new ArrayBlockingQueue&lt;String&gt;(<font color="#000099">200</font>);
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
</node>
<node CREATED="1473844074510" FOLDED="true" ID="ID_1663860896" MODIFIED="1476078667040">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      3&#12289;PayCodeGenerateResult <font color="#009900">result</font>&#160;= orderCreateExtService.getePayCode(orderId);
    </p>
    <p>
      
    </p>
    <p>
      <font color="#cc0000">&#25552;&#21462;paycode&#22833;&#36133;&#21017;&#36864;&#20986;</font>
    </p>
  </body>
</html></richcontent>
<node CREATED="1474271638637" ID="ID_881861119" MODIFIED="1474338724371">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#990099">payCodeServiceImpl</font>.generatePayCode(orderId)
    </p>
  </body>
</html></richcontent>
<node CREATED="1474271762951" ID="ID_468196389" MODIFIED="1474271800976">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      1&#12289;<font color="#009900">result</font>&#160;= new <font color="#990099">PayCodeGenerateResult()</font>
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1474271807947" HGAP="35" ID="ID_1227677744" MODIFIED="1475031020518" VSHIFT="15">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      2&#12289;<font color="#009900">result</font>.setOrderId(orderId)
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1474271830882" ID="ID_631947599" MODIFIED="1474338361007">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      3&#12289;<font color="#009900">result.</font>setPayCode(payCode)
    </p>
    <p>
      
    </p>
    <p>
      paycode&#26159;270&#19975;&#20010;&#25968;&#20540;&#20013;&#30340;&#19968;&#20010;&#20843;&#20301;&#38543;&#26426;&#25968;&#32780;&#24050;
    </p>
  </body>
</html></richcontent>
<node CREATED="1474273144786" ID="ID_1813593769" MODIFIED="1474273179948">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b><font color="#000099">handler</font></b>.<font color="#990099">take()</font>
    </p>
  </body>
</html></richcontent>
<node CREATED="1474273192433" ID="ID_907901202" MODIFIED="1474273232107">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#000099">handler </font>: <b><font color="#990099">PayCodeGernerateHandler</font></b>
    </p>
  </body>
</html></richcontent>
<node CREATED="1474273667499" ID="ID_1802904189" MODIFIED="1474273717227">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#22312;PayCodeServiceImpl&#30340;<font color="#000099">init&#26041;&#27861;&#20013;&#21021;&#22987;&#21270;</font>&#24182;&#21551;&#21160;<font color="#990099">&#24490;&#29615;&#32447;&#31243;</font>
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1474273754700" ID="ID_459863945" MODIFIED="1476068116706">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b><font color="#000099">run</font></b>&#26041;&#27861;
    </p>
    <p>
      
    </p>
    <p>
      &#24490;&#29615;&#32447;&#31243;&#35843;&#29992;&#65292;&#21363;&#27599;step&#25209;&#27425;&#25552;&#21462;paycode&#20379;&#20351;&#29992;
    </p>
  </body>
</html></richcontent>
<node CREATED="1474274032221" ID="ID_212544549" MODIFIED="1474274036684" TEXT="while(true)">
<node CREATED="1474273844708" FOLDED="true" ID="ID_1380546637" MODIFIED="1476078647105">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      1&#12289;RedisSentinelCache.<font color="#000099">rotation</font>(rotationKey,<font color="#990099">step</font>)
    </p>
    <p>
      
    </p>
    <p>
      rotationKey:PAY_CODE_ROTATION_KEY
    </p>
    <p>
      <font color="#990099">step</font>:queueStep
    </p>
  </body>
</html></richcontent>
<node CREATED="1474275428123" ID="ID_1985922833" MODIFIED="1474275461136">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#36127;&#36131;&#25209;&#37327;&#29983;&#25104;paycode,<font color="#cc0000">paycode&#26159;&#24178;&#22043;&#28404;</font>
    </p>
  </body>
</html></richcontent>
<node CREATED="1474335239691" ID="ID_1963820969" MODIFIED="1474335252734" TEXT="PayCodeInitServiceImpl">
<node CREATED="1474336302261" ID="ID_1086537522" MODIFIED="1474338155033">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      initPayCodeRedis
    </p>
    <p>
      
    </p>
    <p>
      redis&#20869;&#23384;&#20837;&#20102;270&#19975;&#20010;&#20843;&#20301;&#25968;&#30340;paycode
    </p>
    <p>
      &#34987;&#24490;&#29615;&#20351;&#29992;
    </p>
  </body>
</html></richcontent>
<node CREATED="1474336619260" ID="ID_1193277683" MODIFIED="1474336798678" TEXT="1&#x3001;Set&lt;Integer&gt; s&#x8d4b;&#x503c;100000&#x4e2a;&#x968f;&#x673a;&#x6570;&#xff0c;&#x4e8b;&#x5b9e;&#x4e0a;&#x8fd9;&#x79cd;&#x5199;&#x6cd5;&#x5f88;&#x72d7;&#x5c4e;&#xff0c;&#x76f4;&#x63a5;&#x8d4b;&#x503c;100000&#x6b21;&#x9012;&#x589e;&#x503c;&#x5373;&#x53ef;&#x554a;&#xff0c;&#x4f60;size&#x8981;&#x6c42;&#x5fc5;&#x987b;100000&#x968f;&#x673a;&#x8fd8;&#x6709;JB&#x610f;&#x4e49;"/>
<node CREATED="1474336855487" ID="ID_704089410" MODIFIED="1474336934762" TEXT="2&#x3001;startSet&#x6709;27&#x4e2a;&#x4e09;&#x4f4d;&#x6570;&#x7684;&#xff0c;&#x4e0d;&#x91cd;&#x590d;&#x7684;&#x6574;&#x6570;&#x6570;&#x7ec4;"/>
<node CREATED="1474337342302" ID="ID_26542718" MODIFIED="1474337374402" TEXT="3&#x3001;&#x5faa;&#x73af;&#x5904;&#x7406;&#x8fd9;27&#x4e2a;&#x4e09;&#x4f4d;&#x6570;&#xff0c;&#x542f;&#x52a8;27&#x4e2a;&#x7ebf;&#x7a0b;&#x5904;&#x7406;">
<node CREATED="1474337389049" ID="ID_557733732" MODIFIED="1474337453715" TEXT="1&#x3001;reids&#x7684;key&#xff08;rotation_prefix_set&#xff09;&#x5bf9;&#x5e94;&#x7684;&#x5217;&#x8868;&#x662f;&#x5426;&#x5df2;&#x5b58;&#x5728;&#xff08;&#x5b58;&#x5728;&#x4ee3;&#x8868;&#x521d;&#x59cb;&#x5316;&#x8fc7;&#x4e86;)"/>
<node CREATED="1474337459939" ID="ID_1034629055" MODIFIED="1474337535499" TEXT="2&#x3001;&#x82e5;&#x4e0d;&#x5b58;&#x5728;&#xff0c;&#x5219; redis&#x4f1a;&#x5199;&#x5165;&#xff0c;&#x540c;&#x65f6;start * 100000&#x4e3a;&#x8d77;&#x59cb;&#x6570;&#x503c;&#xff0c;&#x6b64;&#x65f6;&#x8d77;&#x59cb;&#x6570;&#x503c;&#x4e3a;&#x516b;&#x4f4d;&#x6570;&#x3002;"/>
<node CREATED="1474337565521" ID="ID_1585075570" MODIFIED="1474337812388" TEXT="3&#x3001;&#x5c06;&#x8d77;&#x59cb;&#x503c;&#x4e3a;start*100000&#x7684;100000&#x4e2a;&#x4e0d;&#x540c;&#x6570;&#x503c;&#xff08;&#x5c0f;&#x4e8e;100000&#xff09;&#x6bcf;200&#x4e00;&#x6279;&#x6b21;&#x8ffd;&#x52a0;&#x5230;rotation_key&#x7684;&#x5217;&#x8868;&#x4e2d;">
<node BACKGROUND_COLOR="#ffff99" CREATED="1474337815114" ID="ID_685943789" MODIFIED="1474338097156" TEXT="&#x5373;&#x8be5;key&#x5bf9;&#x5e94;&#x5217;&#x8868;&#x5143;&#x7d20;&#x6570;&#x91cf;&#x4e3a;27*100000&#x4e2a;"/>
</node>
</node>
</node>
</node>
</node>
<node CREATED="1474334372350" ID="ID_1998135548" MODIFIED="1474334536599">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      rotation&#20869;&#37096;&#35843;&#29992;&#20102;p = jedis.pipelined()
    </p>
    <p>
      
    </p>
    <p>
      for&#65288;int i =0;i&lt;step;i++)
    </p>
    <p>
      &#160;&#160;&#160;p.rpoplpush(samekey,samekey)
    </p>
    <p>
      
    </p>
    <p>
      list&lt;object&gt; ret = p.syncAndReturnAll()
    </p>
    <p>
      
    </p>
    <p>
      &#23454;&#38469;&#23601;&#26159;&#23558;&#21516;&#19968;&#20010;key&#23545;&#24212;&#30340;&#21015;&#34920;&#21453;&#22797;&#20174;&#26368;&#21518;&#25552;&#21462;&#20986;&#26469;&#36820;&#22238;&#65292;&#24182;&#20877;&#25554;&#20837;&#21015;&#34920;&#21069;&#21015;&#24453;&#21518;&#32493;&#20877;&#25552;&#21462;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1474274050550" ID="ID_471016095" MODIFIED="1474274394865" TEXT="2&#x3001;for(String payCode : payCodeList){ queue.put(payCode) }"/>
</node>
</node>
</node>
</node>
</node>
<node CREATED="1474271872157" ID="ID_482064447" MODIFIED="1474271913895">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      4&#12289;<font color="#009900">result</font>.setExpireTime(nowTime+<font color="#000099">liveTime</font>)
    </p>
  </body>
</html></richcontent>
<node CREATED="1474338785481" ID="ID_727956199" MODIFIED="1474338796578" TEXT="15&#x5206;&#x949f;&#x7684;&#x652f;&#x4ed8;&#x6709;&#x6548;&#x671f;"/>
</node>
<node CREATED="1474271933308" ID="ID_1291544289" MODIFIED="1474271976664">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      final:&#160;&#160;<font color="#660000">json</font>&#160;= JSON.toJSONString(<font color="#009900">result</font>)
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1474271993132" ID="ID_521537002" MODIFIED="1474272001933" TEXT="then set in redis">
<node CREATED="1474272059955" ID="ID_1326357112" MODIFIED="1474272094887">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      payCodeCache.<font color="#000099">setnx</font>(key,<font color="#660000">json</font>)
    </p>
  </body>
</html></richcontent>
<node CREATED="1474273080898" ID="ID_437733124" MODIFIED="1474338309639">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      set ok then : payCodeCache.<b><font color="#006666">setpx</font></b>(key,millis,<font color="#660000">json</font>)
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node CREATED="1474273128751" ID="ID_1127258017" MODIFIED="1474273141812">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      return <font color="#009900">result</font>
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node CREATED="1474338995673" ID="ID_782625155" MODIFIED="1474339119199">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      4&#12289;&#26681;&#25454;ShopForQuery,OrderId,PayCode&#21019;&#24314;OrderCreateParam&#160;
    </p>
  </body>
</html></richcontent>
<node CREATED="1476259179988" ID="ID_1697886946" MODIFIED="1476344516586" TEXT="fillParam(orderCreateParam,paycodeGenerateResult,ShopForQuery)"/>
</node>
<node BACKGROUND_COLOR="#ffff99" CREATED="1474339144249" ID="ID_636805778" MODIFIED="1476344599106">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      5&#12289;<font color="#660099">orderCreateExtService</font>.<b><font color="#006633">createOrder</font></b>(<font color="#cc0000">orderCreateParam</font>)
    </p>
    <p>
      
    </p>
    <ul>
      <li>
        &#22914;&#26524;tradecenter&#22788;&#29702;&#25104;&#21151;&#65292;&#20174;&#32467;&#26524;&#20013;&#25552;&#21462;orderInfoModel&#23545;&#35937;
      </li>
      <li>
        &#23553;&#35013;OrderBasicModel&#23545;&#35937;&#24182;&#36820;&#22238;
      </li>
    </ul>
  </body>
</html></richcontent>
<node CREATED="1474339276012" ID="ID_1155922202" MODIFIED="1474339330166">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#35843;&#29992;<b><font color="#660099">tradeCenter&#39033;&#30446;</font></b>&#30340;OrderCreateService.CreateOrder(orderCreateParam)
    </p>
  </body>
</html></richcontent>
<node CREATED="1476078864228" ID="ID_1866008054" MODIFIED="1476078900407" TEXT="&#x6392;&#x67e5;&#x65e5;&#x5fd7;&#x8bb0;&#x5f55;&#xff0c;&quot;&#x53c2;&#x6570;&#x4fe1;&#x606f;param= &quot;&#x53ef;&#x67e5;&#x770b;&#x8f93;&#x5165;&#x7684;&#xff0c;&#x521b;&#x5efa;&#x8ba2;&#x5355;&#x53c2;&#x6570;"/>
<node CREATED="1476078919315" ID="ID_1979356558" MODIFIED="1476078931375" TEXT="&#x5177;&#x4f53;&#x6b65;&#x9aa4;">
<node CREATED="1476078953275" FOLDED="true" ID="ID_377498896" MODIFIED="1476079158825" TEXT="1&#x3001;new &#x521b;&#x5efa;OrderCreateDomain &#x5e76;&#x8bbe;&#x7f6e;&#x5c5e;&#x6027; ">
<node CREATED="1476078994215" ID="ID_586070767" MODIFIED="1476079027814">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#35774;&#32622;notifySendManager&#23646;&#24615;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1476079034818" ID="ID_1792741214" MODIFIED="1476079045957" TEXT="&#x8bbe;&#x7f6e;orderCreateParam&#x5c5e;&#x6027;"/>
<node CREATED="1476079055421" ID="ID_999379996" MODIFIED="1476079071933" TEXT="&#x8bbe;&#x7f6e;orderCreateDomainRepository&#x5c5e;&#x6027;"/>
<node CREATED="1476079078456" ID="ID_685413555" MODIFIED="1476079095822" TEXT="&#x8bbe;&#x7f6e;orderQueryDomainRepository&#x5c5e;&#x6027;"/>
</node>
<node CREATED="1476079115902" ID="ID_767504543" MODIFIED="1476079155400" TEXT="2&#x3001;&#x8c03;&#x7528;&#x7edf;&#x4e00;&#x6a21;&#x677f;serviceTemplate&#x6267;&#x884c;&#x521b;&#x5efa;&#x8ba2;&#x5355;&#x5177;&#x4f53;&#x4e1a;&#x52a1;&#xff0c;&#x56fa;&#x5b9a;&#x5206;&#x4e09;&#x6b65;">
<node CREATED="1476079163054" ID="ID_1106231573" LINK="2016/10/OrderCreateDomain.checkParam.java" MODIFIED="1476086552477">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      1&#12289;checkParam
    </p>
    <p>
      
    </p>
    <p>
      &#23454;&#38469;&#35843;&#29992;orderCreateDomain.checkParam()
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1476086637564" ID="ID_156718573" MODIFIED="1476092272456">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      2&#12289;createOrder() (in doAction)
    </p>
  </body>
</html></richcontent>
<node CREATED="1476087362874" ID="ID_1815866790" MODIFIED="1476087401038" TEXT="1&#x3001;orderCreateDomainRepository.insertOrderInfo(fillOrderInfoDo())">
<node CREATED="1476087422541" ID="ID_1144210544" LINK="2016/10/OrderCreateDomain.fillOrderInfoDo.java" MODIFIED="1476087704721" TEXT="fillOrderInfoDo()"/>
<node CREATED="1476087767140" ID="ID_518444844" LINK="2016/10/OrderInfoDAOImpl.insert.java" MODIFIED="1476087869596" TEXT="OrderInfoDAOImpl.insert(orderInfoDo)">
<node CREATED="1476087945809" ID="ID_1543108944" MODIFIED="1476088017452">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#20855;&#20307;&#21442;&#32771;mdtradecenter.dao&#19979;&#30340;mybatis&#30340;md-order-info-sqlmap.xml&#20013;&#12290;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1476089009723" ID="ID_554172526" MODIFIED="1476089037613">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#23601;&#26159;&#22312;md_order_info&#34920;&#20013;&#25554;&#20837;&#19968;&#26465;&#26032;&#35760;&#24405;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1476089220775" ID="ID_1637716732" MODIFIED="1476089254384" TEXT="&#x6392;&#x67e5;&#x65e5;&#x5fd7;&#x8bb0;&#x5f55;&#xff1a;insertOrderInfo&#xff0c;&#x53ef;&#x67e5;&#x65b0;&#x63d2;&#x5165;&#x8bb0;&#x5f55;&#x7684;id"/>
</node>
</node>
<node CREATED="1476089319890" ID="ID_1843967620" MODIFIED="1476089351688" TEXT="2&#x3001;&#x63d2;&#x5165;md_order_info&#x6210;&#x529f;&#x540e;&#xff0c;&#x4f1a;&#x5728;&#x8ba2;&#x5355;&#x6269;&#x5c55;&#x8868;&#x548c;&#x64cd;&#x4f5c;&#x65e5;&#x5fd7;&#x8868;&#x4e2d;&#x63d2;&#x5165;&#x76f8;&#x5e94;&#x8bb0;&#x5f55;">
<node CREATED="1476089424217" ID="ID_902173501" MODIFIED="1476089486285">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#25554;&#20837;&#26085;&#24535;&#25805;&#20316;&#34920;&#24322;&#24120;&#65292;
    </p>
    <p>
      &#21017;&#20250;&#29992;&quot;__&#29305;&#27530;&#23383;&#31526;__&quot;&#20316;&#20026;username&#32487;&#32493;&#20889;&#20837;&#25805;&#20316;&#26085;&#24535;&#34920;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1476089588974" ID="ID_1542935685" MODIFIED="1476092123944">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      3&#12289;orderQueryDomainRepository.queryOrderDetailInfo(orderQueryDetailInfoParam)&#26681;&#25454;orderid&#20174;<font color="#6600ff">md_order_info</font>&#25552;&#21462;&#23545;&#24212;&#30340;&#35760;&#24405;
    </p>
    <p>
      
    </p>
    <p>
      &#24182;&#23553;&#35013;&#21040;callresult&#20013;&#36820;&#22238;
    </p>
  </body>
</html></richcontent>
<node CREATED="1476089856555" ID="ID_1563528633" MODIFIED="1476089914626" TEXT="then,&#x5229;&#x7528;cglib-nodep-2.1.3.jar&#x5f00;&#x6e90;&#x5305;&#x62f7;&#x8d1d;detailinfo&#x5230;OrderInfoModel&#x4e2d;"/>
<node CREATED="1476089956104" ID="ID_467049524" LINK="2016/10/OrderInfoModel.java" MODIFIED="1476092050997" TEXT="OrderInfoModel"/>
<node CREATED="1476089971121" ID="ID_515900600" LINK="2016/10/OrderInfoDO.java" MODIFIED="1476092040302" TEXT="OrderInfoDO">
<node CREATED="1476237743491" ID="ID_535480920" MODIFIED="1476237765843" TEXT="md_order_info ,&#x8ba2;&#x5355;&#x8be6;&#x60c5;&#xff0c;&#x7528;&#x4e8e;&#x67e5;&#x8be2;&#x63cf;&#x8ff0;&#x8282;&#x70b9;"/>
</node>
</node>
</node>
</node>
</node>
</node>
</node>
</node>
</node>
</node>
</node>
</node>
<node CREATED="1474339633320" ID="ID_1705248764" MODIFIED="1476754195990">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b><font color="#006633">5&#12289;</font></b>orderFsService.wftPayOrder(...)
    </p>
    <p>
      
    </p>
    <p>
      &#20027;&#35201;&#26159;createMobileParams&#29992;&#20110;&#25163;&#26426;&#25903;&#20184;&#65311;
    </p>
    <p>
      
    </p>
    <p>
      &#23454;&#38469;&#20851;&#38190;&#21442;&#25968;&#23601;&#26159;&#20808;&#33719;&#21462;&#21040;orderId
    </p>
  </body>
</html></richcontent>
<node CREATED="1474357339993" ID="ID_1885628025" MODIFIED="1476236239706">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      1&#12289;new <font color="#006633">OrderPayDomain </font>
    </p>
    <p>
      
    </p>
    <p>
      &#25414;&#32465;&#36755;&#20837;&#21442;&#25968;order<font color="#006666">PayParam</font>,&#33509;&#24178;&#19994;&#21153;&#23545;&#35937;
    </p>
    <ul>
      <li>
        <font color="#660099">tradeExtService</font>
      </li>
      <li>
        youhuiExtService
      </li>
      <li>
        orderBindDomain<font color="#336600">Repository</font>
      </li>
      <li>
        orderCreateExtService
      </li>
      <li>
        orderRefresh<font color="#336600">DomainRepository</font>
      </li>
      <li>
        mobileMsg
      </li>
      <li>
        publicConfig.<font color="#990099">getMdtKey()&#65292;&#22403;&#22334;&#21442;&#25968;</font>
      </li>
    </ul>
  </body>
</html></richcontent>
<node BACKGROUND_COLOR="#ffff99" CREATED="1476236299252" ID="ID_1503303983" LINK="#ID_500500888" MODIFIED="1476236630589" TEXT="&#x5173;&#x952e;&#x65b9;&#x6cd5;&#xff1a;wftPayOrder()"/>
</node>
<node CREATED="1474357727469" FOLDED="true" ID="ID_1252319875" MODIFIED="1476780795990" TEXT="2&#x3001;mdServiceTemplate.exeWithoutDB(new TemplateAction&lt;OrderPayModel&gt;{checkParam;doAction;checkBiz;finishUp})">
<node CREATED="1474357907795" FOLDED="true" ID="ID_1471057743" MODIFIED="1476236616500">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      checkParam&#160;
    </p>
    <p>
      
    </p>
    <p>
      &#37096;&#20998;&#21442;&#25968;&#19981;&#33021;&#20026;&#31354;&#25110;null
    </p>
  </body>
</html></richcontent>
<node CREATED="1474357944634" ID="ID_523066958" MODIFIED="1474357964258" TEXT="orderPayParam.getOrderId()"/>
<node CREATED="1474357969357" ID="ID_1951149717" MODIFIED="1474357984569" TEXT="orderPayParam.getUseFbalance()"/>
<node CREATED="1474357990299" ID="ID_850144423" MODIFIED="1474357999796" TEXT="orderPayParam.getPayType()"/>
<node CREATED="1474358034540" ID="ID_1193893571" MODIFIED="1474358056114" TEXT="ip,lat,lng,deviceid,devicestr"/>
</node>
<node CREATED="1474358075084" ID="ID_500500888" MODIFIED="1476344631160">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      doAction: <font color="#006633">orderPayDomain</font>.<font color="#660099">wftPayOrder()</font>
    </p>
  </body>
</html></richcontent>
<node CREATED="1474358504179" ID="ID_1982053368" MODIFIED="1476236998599">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#660099">1&#12289;tradeExtService</font>.queryOrderInfoById(orderId)
    </p>
    <p>
      
    </p>
    <p>
      <font color="#cc0000">&#26597;&#35810;&#22833;&#36133;&#65292;&#36864;&#20986;&#24182;&#36820;&#22238;&#22833;&#36133;&#20195;&#30721;&#21644;&#21407;&#22240;</font>
    </p>
  </body>
</html></richcontent>
<node CREATED="1474358563188" ID="ID_52516540" MODIFIED="1474358592658">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#35843;&#29992;<font color="#660099">tradecenter</font>&#39033;&#30446;&#25552;&#21462;&#35746;&#21333;&#35814;&#24773;
    </p>
  </body>
</html></richcontent>
<node CREATED="1476170784388" ID="ID_1873643515" MODIFIED="1476170905792">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      OrderQueryServiceImpl.queryOrderDetailInfo<font color="#cc0000">FromMaster </font>
    </p>
    <p>
      
    </p>
    <p>
      &#23454;&#38469;&#35835;&#30340;&#26159;&#20174;&#24211;&#65292;&#22240;&#20026;&#21442;&#25968;isMaster&#35774;&#32622;&#20026;false&#20102;
    </p>
  </body>
</html></richcontent>
<node CREATED="1476172461791" ID="ID_1719651832" LINK="#ID_1542935685" MODIFIED="1476172713004">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#37319;&#29992;orderQueryDomainRepository
    </p>
    <p>
      
    </p>
    <p>
      &#35843;&#29992;&#20854;&#26041;&#27861;queryOrderDetailInfo(...)
    </p>
    <p>
      
    </p>
    <p>
      &#36825;&#37096;&#20998;&#22788;&#29702;&#23436;&#20840;&#21516;&#20110;createOrder(&#32511;&#33394;&#31661;&#22836;&#25152;&#25351;&#20998;&#25903;)
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
<node CREATED="1474359828598" FOLDED="true" ID="ID_1237226781" MODIFIED="1476238026536">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      2&#12289;&#25552;&#21462;&#36820;&#22238;&#30340;&#32467;&#26524; <font color="#660099">OrderInfoModel</font>&#160; <font color="#006666">data</font>&#160;= remoteOrderCR.getResultObject()
    </p>
    <p>
      
    </p>
    <ol>
      <li>
        <font color="#006666">orderAmount</font>&#160;= data.getOrderAmount(); <b><font color="#006633">//orderAmount&#24212;&#20184;&#27454;&#37329;&#39069;&#12290;</font></b>
      </li>
      <li>
        <font color="#990099">lessPayAmount</font>&#160;= <font color="#006666">orderAmount</font>.setScale(2,BigDecimal.ROUND_HALF_UP);<font color="#990000">//&#22235;&#33293;&#20116;&#20837;&#21518;&#23567;&#20110;&#38646;&#21017;&#36864;&#20986;</font>
      </li>
      <li>
        if(<font color="#990099">lessPayAmount</font>.compareTo(BigDecimal.ZERO)&lt;=0 then <font color="#cc0000">needContinuePay</font>= false;
      </li>
      <li>
        data.getShopId(); <font color="#cc0000">shopid&lt;=0 &#36864;&#20986;</font>
      </li>
    </ol>
  </body>
</html></richcontent>
<node CREATED="1474361133252" ID="ID_1751474471" MODIFIED="1475029831395" TEXT="java&#x4e4b;bigdecimal">
<node CREATED="1474361156255" ID="ID_1651592461" MODIFIED="1474361230239">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      BigDecimal.<font color="#660099">setScale()</font>&#26041;&#27861;&#29992;&#20110;&#26684;&#24335;&#21270;&#23567;&#25968;&#28857;
    </p>
    <ul>
      <li>
        setScale(<font color="#000099">1</font>)&#34920;&#31034;<font color="#000099">&#20445;&#30041;&#19968;&#20301;&#23567;&#25968;</font>&#65292;&#40664;&#35748;&#29992;&#22235;&#33293;&#20116;&#20837;&#26041;&#24335;
      </li>
      <li>
        setScale(1,BigDecimal.ROUND_DOWN)&#30452;&#25509;&#21024;&#38500;&#22810;&#20313;&#30340;&#23567;&#25968;&#20301;&#65292;&#22914;2.35&#20250;&#21464;&#25104;2.3
      </li>
      <li>
        setScale(1,BigDecimal.ROUND_UP)&#36827;&#20301;&#22788;&#29702;&#65292;2.35&#21464;&#25104;2.4
      </li>
      <li>
        setScale(1,BigDecimal.ROUND_HALF_UP)&#22235;&#33293;&#20116;&#20837;&#65292;2.35&#21464;&#25104;2.4
      </li>
      <li>
        setScaler(1,BigDecimal.ROUND_HALF_DOWN)&#22235;&#33293;&#20116;&#20837;&#65292;2.35&#21464;&#25104;2.3&#65292;&#22914;&#26524;&#26159;5&#21017;&#21521;&#19979;&#33293;
      </li>
    </ul>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node CREATED="1474361990494" ID="ID_691112575" LINK="#ID_1289375909" MODIFIED="1476238233493">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      3&#12289;&#20877;&#27425;&#26681;&#25454;<font color="#006633">shopid</font>&#36208;<font color="#660099">dubbo</font>&#20174;<font color="#006666">&#38376;&#24215;&#20013;&#24515;</font>&#25552;&#21462;&#36820;&#29616;&#26041;&#26696;&#65292;&#22914;&#26524;<font color="#cc0000">&#25552;&#21462;&#24322;&#24120;&#21017;&#36864;&#20986;&#65281;</font>
    </p>
  </body>
</html></richcontent>
<node CREATED="1476238272149" ID="ID_1720308229" MODIFIED="1476238279196" TEXT="&#x8fd4;&#x56de;&#x8282;&#x70b9;&#x800c;&#x5df2;"/>
</node>
<node CREATED="1474362382841" FOLDED="true" ID="ID_1607371615" MODIFIED="1476780794047">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      4&#12289;&#22914;&#26524;<font color="#006633">needContinuePay = true</font>&#65292;&#21017;&#25171;&#21253;<font color="#006633">orderPayModel&#30456;&#20851;&#24517;&#35201;&#21442;&#25968;</font><font color="#990099">&#20934;&#22791;&#36208;</font>&#31532;&#19977;&#26041;&#25903;&#20184;&#65292;<font color="#006600">&#21542;&#21017;&#65292;&#30452;&#25509;&#26174;&#31034;&#25903;&#20184;&#25104;&#21151; </font>
    </p>
    <p>
      
    </p>
    <p>
      <font color="#0066cc">&#23454;&#38469;&#23601;&#26159;&#35201;&#20040;&#24050;&#25903;&#20184;&#65292;&#35201;&#20040;&#23601;&#26159;&#25903;&#20184;&#37329;&#39069;&#20026;0&#65292;&#21542;&#21017;&#37117;&#35201;&#32487;&#32493;&#36208;&#25903;&#20184;&#27969;&#31243; </font>
    </p>
    <p>
      
    </p>
    <p>
      &#30456;&#23545;&#20110;&#31532;&#19977;&#26041;&#25903;&#20184;&#65292;&#20197;&#21069;&#26377;&#33258;&#24049;&#30340;&#25903;&#20184;&#36884;&#24452;&#65311;<font color="#006666">&#26377;&#65292;&#23601;&#26159;&#20313;&#39069;&#26469;&#25903;&#20184;</font>
    </p>
  </body>
</html></richcontent>
<node CREATED="1474362796844" ID="ID_1940210464" MODIFIED="1474362999694">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      1&#12289;&#22914;&#26524;orderPayParam.getPayType() == OrderPayParam.NO_PAY_TYPE
    </p>
    <p>
      
    </p>
    <p>
      <b><font color="#000099">&#21017;&#36864;&#20986;</font></b>&#65292;&#24182;&#25552;&#31034;&#38656;&#35201;<font color="#006666">CLIENTPAY&#26041;&#24335;</font>&#22788;&#29702;orderPayModel&#25968;&#25454;&#23436;&#25104;&#25903;&#20184;&#65292;&#19981;&#26159;&#31532;&#19977;&#26041;&#21734;&#12290;<font color="#cc0000">&#36825;&#20010;&#24212;&#35813;&#30446;&#21069;&#19981;&#23384;&#22312;&#36825;&#31181;&#22788;&#29702;</font>
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1474363013851" ID="ID_1634933514" MODIFIED="1476239902232">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      2&#12289;<b><font color="#990099">tradeExtService</font></b>.<b><font color="#000099">createMobileParam</font></b>(orderPayParam,data,lessPayAmount,<font color="#ff3333">mobileKey</font>)
    </p>
    <p>
      
    </p>
    <p>
      <font color="#cc0000">&#33719;&#21462;&#31532;&#19977;&#26041;&#25903;&#20184;&#21442;&#25968;&#22833;&#36133;&#65292;&#21017;&#36864;&#20986; </font>
    </p>
    <p>
      
    </p>
    <p>
      &#25630;&#28165;&#26970;&#36825;&#20010;mobileKey&#30340;&#36755;&#20837;&#28857;&#65292;&#35813;&#20540;&#29992;&#20110;<font color="#660099">&#21019;&#24314;&#31614;&#21517;</font>
    </p>
  </body>
</html></richcontent>
<arrowlink DESTINATION="ID_1634933514" ENDARROW="Default" ENDINCLINATION="0;0;" ID="Arrow_ID_1818610020" STARTARROW="None" STARTINCLINATION="0;0;"/>
<linktarget COLOR="#b0b0b0" DESTINATION="ID_1634933514" ENDARROW="Default" ENDINCLINATION="0;0;" ID="Arrow_ID_1818610020" SOURCE="ID_1634933514" STARTARROW="None" STARTINCLINATION="0;0;"/>
<icon BUILTIN="messagebox_warning"/>
<node CREATED="1474363488015" ID="ID_1271390045" MODIFIED="1476174005012">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      1&#12289;&#26681;&#25454;(orderInfoModel.<font color="#cc0000">getPayLimitTime()</font>&#160;- currTime&#160;)/1000/60&#33719;&#21462;&#21333;&#20301;&#20026;&#20998;&#38047;&#30340;&#36807;&#26399;&#26102;&#38388;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1474364611449" ID="ID_1140826665" LINK="2016/10/TradeVo.java" MODIFIED="1476668539263">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      2&#12289;new <b><font color="#006666">TradVo</font></b>&#160;
    </p>
    <p>
      
    </p>
    <p>
      tradeVo&#30340;tradeid&#37319;&#29992;&#30340;&#23601;&#26159;<font color="#990099"><b>orderId</b></font>
    </p>
  </body>
</html></richcontent>
<node CREATED="1474364649730" ID="ID_94556266" MODIFIED="1474364733062">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#35774;&#32622;&#21508;&#31181;&#24517;&#39035;&#21442;&#25968;
    </p>
    <p>
      
    </p>
    <p>
      &#20851;&#38190;&#30340;&#26159;<font color="#000099">&#26681;&#25454;paytype&#65292;&#35774;&#32622;paytype,openid,authcode&#31561;&#20851;&#38190;&#21442;&#25968;</font>
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1474364755648" ID="ID_1842444216" MODIFIED="1474365482686">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      3&#12289;String secret = <font color="#000099">createSecrect</font>(tradeVo,mobileKey);
    </p>
    <p>
      
    </p>
    <p>
      &#23454;&#38469;&#23601;&#26159;&#26681;&#25454;&#25903;&#20184;&#23453;&#65292;&#24494;&#20449;&#36890;&#29992;&#30340;&#39564;&#31614;&#26041;&#24335;&#36827;&#34892;&#31614;&#21517;&#24182;&#36820;&#22238;&#35813;&#31614;&#21517;&#20540;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1474365516866" ID="ID_1386556895" MODIFIED="1474426112874">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      4&#12289;&#35843;&#29992;<b><font color="#990099">mdpaygate&#39033;&#30446;</font></b>&#30340;tradeService.createMobileParams(tradeVo,secret);
    </p>
    <p>
      
    </p>
    <p>
      &#36820;&#22238;&#30456;&#20851;&#30340;<font color="#000099">&#31532;&#19977;&#26041;&#25903;&#20184;&#21442;&#25968;&#38598;&#21512;Map&lt;string,string&gt;</font>
    </p>
  </body>
</html></richcontent>
<node CREATED="1474943021151" ID="ID_1784036961" MODIFIED="1474943136350">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      1&#12289;&#33719;&#21462;&#22522;&#20110;redis&#30340;&#20998;&#24067;&#38145;MD_PAY_GATE_createMobileParams_tradeId
    </p>
    <p>
      
    </p>
    <p>
      <font color="#cc0000">&#33719;&#21462;&#20998;&#24067;&#38145;&#22833;&#36133;&#30452;&#25509;&#36864;&#20986;</font>
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1474943154152" FOLDED="true" ID="ID_709845415" MODIFIED="1476780790665">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      2&#12289;&#35843;&#29992;&#22522;&#20110;&#27169;&#26495;serviceTemplate.<b><font color="#0000cc">exInTransaction</font></b>
    </p>
  </body>
</html></richcontent>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1474943212199" ID="ID_289731078" MODIFIED="1476693174995" TEXT="&#x5b9e;&#x73b0;doAction&#x65b9;&#x6cd5;">
<icon BUILTIN="messagebox_warning"/>
<node CREATED="1474944030269" ID="ID_98790767" MODIFIED="1474944118274">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      1&#12289;&#20026;paraMap&#35774;&#32622;&#20851;&#38190;&#21442;&#25968;payType&#23545;&#24212;&#30340;partnerid,alipayid,privateRSAKey
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1476671245122" FOLDED="true" ID="ID_1934980311" MODIFIED="1476693400364">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      2&#12289;&#26681;&#25454;tradeid(&#23454;&#38469;&#23601;&#26159;orderid&#65292;<font color="#0033cc">&#36825;&#37324;tradeid&#36739;&#20043;tradeno&#23569;&#20102;&#26368;&#21518;&#22235;&#20301;&#25968;</font>)&#65292;&#20174;md_pay_trade&#25552;&#21462;<font color="#006666">lastDomin&#35760;&#24405;(&#20134;&#21363;tradeid&#21487;&#23545;&#24212;&#22810;&#20010;tradeno,&#21407;&#22240;&#30475;&#21518;&#38754;&#65292;&#25552;&#21462;&#26368;&#21518;&#30340;&#19968;&#27425;)</font>&#65292;<font color="#ff3300">&#33509;&#20026;&#31354;</font>&#65292;&#21017;&#35843;&#29992;tradeDomainRepository.<font color="#990099"><b>createTradeDomain</b></font>(tradeVO)&#21019;&#24314;&#26032;&#35760;&#24405;,&#24182;&#29983;&#25104;&#20132;&#26131;&#21495;tradeno:
    </p>
    <p>
      tradeno&#32452;&#25104;&#20026;&#65306;z&#26085;&#26399;+&#39034;&#24207;&#20998;&#37197;&#30340;&#25972;&#25968;&#24207;&#21495;+0000&#65292;&#36215;&#22987;&#25968;&#20026;0&#65292;&#21363;z&#26085;&#26399;+&#39034;&#24207;&#20998;&#37197;&#25972;&#25968;&#24207;&#21495;&#30340;&#35746;&#21333;&#65292;&#26368;&#22810;&#21487;&#23581;&#35797;10000&#27425;&#65292;&#20294;&#31243;&#24207;&#37324;&#20889;&#27515;&#20026;1000&#27425;&#23601;&#20316;&#24223;&#20102;&#25913;&#35746;&#21333;
    </p>
  </body>
</html></richcontent>
<node CREATED="1476672056020" ID="ID_290827936" MODIFIED="1476672243356">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#006600">&#33509;&#19981;&#20026;&#31354;</font>&#65292;&#21363;&#23384;&#22312;&#20132;&#26131;&#35760;&#24405;
    </p>
  </body>
</html></richcontent>
<node CREATED="1476672723252" ID="ID_865066156" MODIFIED="1476672789893">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#33509;&#35746;&#21333;&#29366;&#24577;&#20026;<font color="#006600">&#20132;&#26131;&#25104;&#21151;</font>&#25110;<font color="#ff3300">&#20851;&#38381;</font>&#65292;&#21017;<font color="#0033cc">&#30452;&#25509;&#20197;&#22833;&#36133;&#29366;&#24577;&#36864;&#20986;</font>&#65292;&#21578;&#30693;&#24050;&#32463;&#32467;&#26463;&#35813;&#20132;&#26131;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1476672946720" ID="ID_258883582" MODIFIED="1476673013396" TEXT="&#x5426;&#x5219;">
<node CREATED="1476672867052" ID="ID_1626557597" MODIFIED="1476672965461">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      1&#65292;tradeVo&#33509;&#26377;externToken&#65292;&#21017;&#22312;tradeDomain&#24050;&#23384;&#35760;&#24405;&#20013;&#36861;&#21152;externToken
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1476672971493" ID="ID_1422594831" MODIFIED="1476672991144" TEXT="2&#x3001;&#x4e3a;tradeDomain&#x8bbe;&#x7f6e;payBank"/>
<node CREATED="1476673015549" FOLDED="true" ID="ID_1862400954" MODIFIED="1476691407202">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      3&#12289;&#33509;tradeVo&#20013;tradeNo<font color="#006600">&#19981;&#20026;&#31354;</font>
    </p>
  </body>
</html></richcontent>
<node CREATED="1476673168671" FOLDED="true" ID="ID_951868515" MODIFIED="1476691384835">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#33509;tradVo&#30340;tradeNo<font color="#ff3300">&#19981;&#31561;&#20110;</font>lastDomain&#30340;tradeNo
    </p>
  </body>
</html></richcontent>
<node CREATED="1476673500419" ID="ID_1581461684" MODIFIED="1476674330303">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#23581;&#35797;&#20851;&#38381;lastDomain&#23545;&#24212;&#30340;&#20132;&#26131;&#35760;&#24405;&#65292;&#27880;&#24847;&#26159;&#35760;&#24405;&#65292;&#19981;&#26159;&#20132;&#26131;&#65281;
    </p>
    <p>
      <font color="#009999">boolClose = lastDomain.close(); </font>
    </p>
    <p>
      
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1476674307368" ID="ID_369352062" MODIFIED="1476674600126">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#29992;tradeVo&#30340;tradeNo<font color="#006600">&#20877;&#27425;&#25552;&#21462;</font>tradeDomin&#65292;<font color="#ff3300">&#33509;&#19981;&#23384;&#22312;</font>&#65292;&#21017;<font color="#0033cc">&#21019;&#24314;&#26032;&#30340;&#20132;&#26131;&#35760;&#24405;</font>&#65292;&#24182;&#36820;&#22238;tradeDomin
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1476674413765" ID="ID_1865340884" MODIFIED="1476674560423">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#33509; tradeVo.tradeNo == lastDomin.tradeNo
    </p>
    <p>
      
    </p>
    <p>
      &#26356;&#26032;lastDomain&#30340;<font color="#0033cc">payType</font>&#20026;tradeVo.getPayType()
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1476674504540" ID="ID_403896041" MODIFIED="1476674546133">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      3.1&#12289;&#33509;tradeVo.tradeNo<font color="#ff3300">&#20026;&#31354;&#65281;</font>
    </p>
  </body>
</html></richcontent>
<node CREATED="1476691253559" ID="ID_912905032" LINK="#ID_369352062" MODIFIED="1476691290196" TEXT="&#x5224;&#x65ad;&#x5176;&#x662f;&#x5426;&#x53ef;&#x7528;&#xff0c;&#x82e5;&#x4e0d;&#x53ef;&#x7528;&#xff0c;&#x5219;&#x5173;&#x95ed;&#x8ba2;&#x5355;&#xff0c;&#x521b;&#x5efa;&#x65b0;&#x7684;&#x4ea4;&#x6613;&#x8bb0;&#x5f55;"/>
<node CREATED="1476691394531" ID="ID_173675887" MODIFIED="1476693087881">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#19981;&#21487;&#29992;&#26465;&#20214;&#20026;&#65306;
    </p>
  </body>
</html></richcontent>
<node CREATED="1476692257492" ID="ID_765264758" MODIFIED="1476692431144" TEXT="businessType&#x4e0e;tradeVo.businessType&#x4e0d;&#x7b26;"/>
<node CREATED="1476692433215" ID="ID_307419248" MODIFIED="1476692481562" TEXT="tradeMoney&#x4e0e;tradeVo.payMoney&#x4e0d;&#x7b26;"/>
<node CREATED="1476692496267" ID="ID_1684018336" MODIFIED="1476692545705" TEXT="payType&#x4e0d;&#x7b26;&#xff0c;&#x65f6;&#x95f4;&#x8fc7;&#x671f;&#xff0c;&#x4e0d;&#x662f;&#x65b0;&#x521b;&#x5efa;&#x72b6;&#x6001;&#xff0c;&#x90fd;&#x5c06;&#x89c6;&#x4e3a;&#x4e0d;&#x53ef;&#x7528;"/>
</node>
</node>
</node>
</node>
</node>
<node CREATED="1476693177315" ID="ID_137567886" MODIFIED="1476693282774">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      3&#12289;partnerId,alipayId,privateRSAKey&#26377;&#19968;&#20010;&#20026;&#31354;&#65292;&#21363;&#20197;&#22833;&#36133;&#29366;&#24577;&#36864;&#20986;&#22788;&#29702;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1476693292766" ID="ID_87125214" MODIFIED="1476693373679">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      4&#12289;&#35774;&#32622;tradeDomain.setSellerAccountName(alipayId)
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;tradeDomain.setOpenId(tradeVo.getOpenId())
    </p>
  </body>
</html></richcontent>
</node>
<node BACKGROUND_COLOR="#ffffcc" CREATED="1476675180967" ID="ID_1749462268" MODIFIED="1476693382285">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      5&#12289;tradeDomain.getMobileResult
    </p>
  </body>
</html></richcontent>
<icon BUILTIN="messagebox_warning"/>
<node CREATED="1476777385928" ID="ID_642623755" MODIFIED="1476777530115">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#26680;&#24515;&#23601;&#19968;&#21477;&#65306;String url = createMobileParam(clientIp,imei,<font color="#006600">partnerid</font>,<font color="#990099">sellerid</font>,<font color="#660066">privateRSAKey</font>)
    </p>
    <p>
      
    </p>
    <p>
      &#26500;&#36896;&#29992;&#20110;&#25163;&#26426;&#31471;&#35831;&#27714;&#31532;&#19977;&#26041;&#25903;&#20184;&#30340;url&#25110;&#32773;&#34920;&#21333;form&#20449;&#24687;
    </p>
  </body>
</html>
</richcontent>
<node BACKGROUND_COLOR="#ffff99" CREATED="1476777875382" ID="ID_1059146717" MODIFIED="1476779680512">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      1&#12289;TradePayManager <font color="#660066">tradePayManager</font>&#160;= getTradePayManager();
    </p>
    <p>
      
    </p>
    <p>
      &#37117;&#26159;&#38582;&#23646;&#20110;tradeDomain&#23545;&#35937;&#20869;
    </p>
    <p>
      
    </p>
    <p>
      <font color="#006600">&#36825;&#37324;tradePayManager&#26377;N&#22810;&#20010;&#23454;&#29616;&#23545;&#24212;N&#22810;&#20010;&#21512;&#20316;&#25903;&#20184;&#31532;&#19977;&#26041;,</font><font color="#000099">&#26681;&#25454;paytype&#20174;&#23383;&#20856;&#37324;&#25552;&#21462;&#30456;&#24212;&#30340;tradepaymananger&#23454;&#20363;</font>
    </p>
  </body>
</html>
</richcontent>
</node>
<node CREATED="1476779688228" ID="ID_399079718" MODIFIED="1476780726139">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      2&#12289;String requestUrl =&#160;<font color="#000099">tradePayManager</font>.<font color="#990099">createMobileParam</font>(...)&#21516;&#20110;&#36755;&#20837;&#21442;&#25968;&#21015;&#34920;
    </p>
    <p>
      
    </p>
    <p>
      <font color="#cc0000">&#21508;&#31867;&#20855;&#20307;&#23454;&#29616;&#65281;&#32780;&#23454;&#38469;&#20013;</font><font color="#006666">&#24456;&#22810;(&#19981;&#26159;&#20840;&#37096;,alipay&#23601;&#26159;&#26500;&#24314;url)</font><font color="#cc0000">&#24050;&#32463;&#23454;&#38469;</font><font color="#000099">&#35843;&#29992;&#20102;&#31532;&#19977;&#26041;&#25903;&#20184;&#25509;&#21475;&#23436;&#25104;&#20102;&#25903;&#20184;&#21834;</font><font color="#cc0000">&#65281; </font>
    </p>
    <p>
      
    </p>
    <p>
      <font color="#cc0000">&#32780;&#36820;&#22238;&#30340;&#19981;&#26159;&#20160;&#20040;&#29399;&#23617;url&#65292;&#32780;&#26159;&#21508;&#31867;</font><font color="#006600">xml,json&#31561;&#25903;&#20184;&#32467;&#26524;</font><font color="#cc0000">&#30340;&#25968;&#25454;&#26684;&#24335;</font>
    </p>
  </body>
</html>
</richcontent>
</node>
</node>
</node>
<node BACKGROUND_COLOR="#ffcccc" CREATED="1476780538602" ID="ID_83680463" MODIFIED="1476780643095">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      6&#12289;&#30446;&#21069;&#30475;&#26469;<b><font color="#cc0000">&#27492;&#27493;&#39588;&#22810;&#20313;</font></b>&#65292;tradeDomainRepository.storageNewTradeDomain(tradeDomain) &#160;or&#160;&#160;tradeDomainRepository.storageUpdateTradeDomain(tradeDomain)
    </p>
  </body>
</html>
</richcontent>
</node>
<node CREATED="1474944144806" ID="ID_1182645934" MODIFIED="1474944407338">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      2&#12289;&#26681;&#25454;trade_id&#20174;<b><font color="#0000cc">md_pay_trade</font></b>&#34920;&#25552;&#21462;&#23545;&#24212;&#35760;&#24405;&#24182;&#25353;pay_trade_id&#20027;&#38190;&#38477;&#24207;&#25490;&#24207;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1476348112185" ID="ID_785734793" LINK="2016/10/TradeServiceImpl.createMobileParams%5BcheckParams%5D.java" MODIFIED="1476348278802" TEXT="checkParam"/>
<node CREATED="1476348125349" ID="ID_566806444" LINK="2016/10/TradeServiceImpl.createMobileParams%5BdoAction%5D.java" MODIFIED="1476348213603" TEXT="doAction"/>
</node>
</node>
</node>
<node CREATED="1474365721529" ID="ID_1218791231" MODIFIED="1474365770619" TEXT="3&#x3001;&#x6839;&#x636e;&#x8fd4;&#x56de;&#x7684;Map&lt;String,String&gt;&#x6253;&#x5305;&#x8fdb;orderPayModel&#x540e;&#x8fd4;&#x56de;"/>
</node>
<node CREATED="1476238725883" ID="ID_1309531412" MODIFIED="1476238742292" TEXT="&#x6700;&#x7ec8;&#x8fd4;&#x56de;OrderPayModel"/>
</node>
</node>
</node>
<node CREATED="1476236684044" ID="ID_626171637" MODIFIED="1476236792433">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b><font color="#336600">6&#12289;</font></b>getAdapterResultFromSuccess(shOrderCreateParam,<font color="#660099">bindOrderResult</font>,<font color="#336600">payOrderResult</font>)
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
<node CREATED="1476067932313" FOLDED="true" ID="ID_1029663343" MODIFIED="1476067961862" TEXT="&#x53c2;&#x6570;&#x5bf9;&#x8c61;">
<node CREATED="1476067921229" FOLDED="true" ID="ID_1544122475" MODIFIED="1476067958950" TEXT="shOrderCreateParam">
<node CREATED="1476067944680" ID="ID_344495042" MODIFIED="1476067953776">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#160;/* &#29992;&#25143;id&#65292;&#24517;&#22635; */
    </p>
    <p>
      &#160;&#160;&#160;&#160;private long userId;
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;private String userName;
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;/* &#38376;&#24215;id */
    </p>
    <p>
      &#160;&#160;&#160;&#160;private long shopId;
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;/* &#28040;&#36153;&#37329;&#39069; */
    </p>
    <p>
      &#160;&#160;&#160;&#160;private float consumeMoney;
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;/* &#19981;&#21442;&#19982;&#36820;&#29616;&#37329;&#39069; */
    </p>
    <p>
      &#160;&#160;&#160;&#160;private float outRebate;
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;/* &#20195;&#37329;&#21048;id&#12290;&#22914;&#26524;&#26410;&#20351;&#29992;&#21017;&#20026;0 */
    </p>
    <p>
      &#160;&#160;&#160;&#160;private long voucherId;
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;/* &#26159;&#21542;&#36866;&#29992;&#36820;&#29616;&#37329;&#39069; */
    </p>
    <p>
      &#160;&#160;&#160;&#160;private boolean useRebate;
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;/*
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;* &#25903;&#20184;&#26041;&#24335;&#65306; &quot;0&quot;&#65306;&#19981;&#20351;&#29992;&#31532;&#19977;&#26041;&#25903;&#20184;&#26041;&#24335; &quot;1&quot; &quot;&#25903;&#20184;&#23453;&#32593;&#39029;&#25903;&#20184;&quot; &quot;2&quot; &quot;&#25903;&#20184;&#23453;&#38065;&#21253;&#25903;&#20184;&quot; &quot;3&quot; &quot;&#25903;&#20184;&#23453;&#19968;&#38190;&#25903;&#20184;&quot; &quot;4&quot;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;* &quot;&#36130;&#20184;&#36890;&#32593;&#39029;&#25903;&#20184;&quot; &quot;6&quot; &quot;&#24494;&#20449;&#23458;&#25143;&#31471;&#25903;&#20184;&quot; &quot;7&quot; &quot;&#25903;&#20184;&#23453;&#26032;&#29256;&#25910;&#38134;&#21488;&quot;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;*/
    </p>
    <p>
      &#160;&#160;&#160;&#160;private int payType;
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;/* &#35746;&#21333;id&#12290;&#22914;&#26524;&#35813;&#21442;&#25968;&#20026;0 */
    </p>
    <p>
      &#160;&#160;&#160;&#160;private String orderId;
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;private String pid;
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;private String mid;
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;private String mobilePhone;
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;private String isWeChat;
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;private String openId;
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;private long operatorId;
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;private String authCode;
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;private String operatorName;
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
</node>
<node CREATED="1473239392163" FOLDED="true" ID="ID_1614984069" MODIFIED="1476064914555" POSITION="right" TEXT="&#x6389;&#x5355;&#x539f;&#x56e0;">
<node CREATED="1473642682149" ID="ID_359865984" MODIFIED="1475029831429" TEXT="&#x652f;&#x4ed8;&#x5b9d;">
<node CREATED="1473318673560" ID="ID_130624948" MODIFIED="1473318715281">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      0907,Z1609075242
    </p>
    <p>
      &#25481;&#21333;&#65292;1&#28857;&#19979;&#30340;&#21333;&#65292;7&#28857;26&#25165;&#22238;&#35843;&#65292;&#23548;&#33268;&#25481;&#21333;
    </p>
    <p>
      &#25903;&#20184;&#23453;
    </p>
  </body>
</html></richcontent>
</node>
<node CREATED="1473239404606" ID="ID_294480010" MODIFIED="1473239429839" TEXT="0907&#xff0c;&#x652f;&#x4ed8;&#x5b9d;&#x6389;&#x5355;&#x90fd;&#x662f;&#x56e0;&#x4e3a;&#x6ca1;&#x6709;&#x6536;&#x5230;&#x56de;&#x8c03;&#x5bfc;&#x81f4;&#xff0c;&#x6b64;&#x79cd;&#x60c5;&#x51b5;&#x65e0;&#x6cd5;&#x63a7;&#x5236;"/>
<node CREATED="1473398313812" ID="ID_1819768831" MODIFIED="1473398399236">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      0908,Z160908137236&#65292;&#22238;&#35843;&#26102;&#38388;&#22826;&#26202;
    </p>
    <p>
      15:22&#19979;&#21333;&#65292;18&#65306;21&#22238;&#35843;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1473642706972" ID="ID_301418756" MODIFIED="1475029831434" TEXT="&#x5fae;&#x4fe1;">
<node CREATED="1473397852344" ID="ID_1031782235" MODIFIED="1473398042788">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      0908&#65292;Z160908311412,&#30830;&#23450;&#35843;&#29992;
    </p>
    <p>
      com.shanhui.service.shop.ShopService.getShopAndNowRebateById(long)&#26410;&#36820;&#22238;
    </p>
    <p>
      
    </p>
    <p>
      &#38376;&#24215;id:8028258
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node CREATED="1473660030276" FOLDED="true" ID="ID_421232651" MODIFIED="1475030016120" POSITION="right" TEXT="other">
<node CREATED="1473660039127" ID="ID_1634373046" MODIFIED="1475029831546">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      redis&#25805;&#20316;&#33539;&#20363;
    </p>
    <p>
      
    </p>
    <p>
      set<font color="#0033cc">nx</font>&#31995;&#21015;&#65292;set if <font color="#0033cc">n</font>ot e<font color="#0033cc">x</font>ist
    </p>
  </body>
</html></richcontent>
<node CREATED="1473660048468" ID="ID_260339712" MODIFIED="1473663835365">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      package com.naxsu.redis;
    </p>
    <p>
      
    </p>
    <p>
      import static org.junit.Assert.*;
    </p>
    <p>
      
    </p>
    <p>
      import java.util.ArrayList;
    </p>
    <p>
      import java.util.List;
    </p>
    <p>
      
    </p>
    <p>
      import org.junit.Before;
    </p>
    <p>
      import org.junit.Test;
    </p>
    <p>
      
    </p>
    <p>
      import redis.clients.jedis.Jedis;
    </p>
    <p>
      import redis.clients.jedis.exceptions.JedisDataException;
    </p>
    <p>
      
    </p>
    <p>
      /**
    </p>
    <p>
      &#160;* &#23545;String&#31867;&#22411;&#36827;&#34892;&#25805;&#20316;
    </p>
    <p>
      &#160;* &#20026;&#20102;&#20731;&#20813;&#19978;&#38754;&#30340;&#27979;&#35797;&#30340;&#32467;&#26524;&#24433;&#21709;&#21040;&#24403;&#21069;&#27979;&#35797;&#26041;&#27861;&#65292;&#27979;&#35797;&#20043;&#21069;&#20808;&#25226;&#25968;&#25454;&#24211;&#32473;&#28165;&#31354;
    </p>
    <p>
      &#160;*/
    </p>
    <p>
      public class StringValuesCommandsTest{
    </p>
    <p>
      Jedis jedis = null;
    </p>
    <p>
      
    </p>
    <p>
      @Before
    </p>
    <p>
      public void before(){
    </p>
    <p>
      jedis = new Jedis(&quot;192.168.26.128&quot;);
    </p>
    <p>
      jedis.auth(&quot;123456&quot;);
    </p>
    <p>
      
    </p>
    <p>
      jedis.flushDB();
    </p>
    <p>
      }
    </p>
    <p>
      
    </p>
    <p>
      @Test
    </p>
    <p>
      public void flushDB() {
    </p>
    <p>
      jedis.flushDB();// &#28165;&#31354;redis
    </p>
    <p>
      }
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;@Test
    </p>
    <p>
      &#160;&#160;&#160;&#160;public void setAndGet() {
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;//&#23545;key&#20026;foo&#36827;&#34892;&#36171;&#20540;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;String status = jedis.set(&quot;foo&quot;, &quot;bar&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//&#36820;&#22238;OK
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(&quot;OK&quot;, status);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//&#33719;&#21462;key&#20026;foo&#30340;&#20540;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;String value = jedis.get(&quot;foo&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//&#21462;&#20986;&#30340;&#20540;&#20026;bar,&#25152;&#20197;&#30456;&#31561;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(&quot;bar&quot;, value);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//&#30001;&#20110;&#19981;&#23384;&#22312;&#21517;&#20026;bar&#30340;key,&#25152;&#20197;&#21462;&#20986;&#26469;&#30340;&#20540;&#20026;null
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(null, jedis.get(&quot;bar&quot;));
    </p>
    <p>
      &#160;&#160;&#160;&#160;}
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;@Test
    </p>
    <p>
      &#160;&#160;&#160;&#160;public void getSet() {
    </p>
    <p>
      &#160;&#160;&#160;&#160; <font color="#006600">//&#23558;foo&#30340;&#20540;&#35774;&#20026;bar&#65292;&#24182;</font><font color="#ff3300">&#36820;&#22238;foo&#30340;&#26087;&#20540;</font>
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;String value = jedis.<font color="#0033cc">getSet</font>(&quot;foo&quot;, &quot;bar&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//&#26087;&#20540;&#20026;null
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(null, value);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;value = jedis.get(&quot;foo&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(&quot;bar&quot;, value);
    </p>
    <p>
      &#160;&#160;&#160;&#160;}
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;@Test
    </p>
    <p>
      &#160;&#160;&#160;&#160;public void mget() {
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;//mget:&#36820;&#22238;&#25152;&#26377;(&#19968;&#20010;&#25110;&#22810;&#20010;)&#32473;&#23450;key&#30340;&#20540;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;List&lt;String&gt; values = jedis.mget(&quot;foo&quot;, &quot;bar&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;List&lt;String&gt; expected = new ArrayList&lt;String&gt;();
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;expected.add(null);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;expected.add(null);
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(expected, values);
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;jedis.set(&quot;foo&quot;, &quot;bar&quot;);
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;expected = new ArrayList&lt;String&gt;();
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;expected.add(&quot;bar&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;expected.add(null);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;values = jedis.mget(&quot;foo&quot;, &quot;bar&quot;);
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(expected, values);
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;jedis.set(&quot;bar&quot;, &quot;foo&quot;);
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;expected = new ArrayList&lt;String&gt;();
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;expected.add(&quot;bar&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;expected.add(&quot;foo&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;values = jedis.mget(&quot;foo&quot;, &quot;bar&quot;);
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(expected, values);
    </p>
    <p>
      &#160;&#160;&#160;&#160;}
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;@Test
    </p>
    <p>
      &#160;&#160;&#160;&#160;public void setnx() {
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;//setnx&#65306;&#23558;key&#30340;&#20540;&#35774;&#20026;value&#65292;&#24403;&#19988;&#20165;&#24403;key&#19981;&#23384;&#22312;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;long status = jedis.setnx(&quot;foo&quot;, &quot;bar&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(1, status);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(&quot;bar&quot;, jedis.get(&quot;foo&quot;));
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;status = jedis.setnx(&quot;foo&quot;, &quot;bar2&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(0, status);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(&quot;bar&quot;, jedis.get(&quot;foo&quot;));
    </p>
    <p>
      &#160;&#160;&#160;&#160;}
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;@Test
    </p>
    <p>
      &#160;&#160;&#160;&#160;public void setex() {
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;//&#32473;foo&#35774;&#32622;&#29983;&#23384;&#26102;&#38388;&#35774;&#20026;20&#31186;,&#20540;&#20026;bar
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;String status = jedis.setex(&quot;foo&quot;, 20, &quot;bar&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(&quot;OK&quot;, status);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//&#36820;&#22238;foo&#30340;&#21097;&#20313;&#29983;&#23384;&#26102;&#38388;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;long ttl = jedis.ttl(&quot;foo&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertTrue(ttl &gt; 0 &amp;&amp; ttl &lt;= 20);
    </p>
    <p>
      &#160;&#160;&#160;&#160;}
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;@Test
    </p>
    <p>
      &#160;&#160;&#160;&#160;public void mset() {
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;//mset:&#21516;&#26102;&#35774;&#32622;&#19968;&#20010;&#25110;&#22810;&#20010;key-value&#23545;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;String status = jedis.mset(&quot;foo&quot;, &quot;bar&quot;, &quot;bar&quot;, &quot;foo&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(&quot;OK&quot;, status);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(&quot;bar&quot;, jedis.get(&quot;foo&quot;));
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(&quot;foo&quot;, jedis.get(&quot;bar&quot;));
    </p>
    <p>
      &#160;&#160;&#160;&#160;}
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;@Test
    </p>
    <p>
      &#160;&#160;&#160;&#160;public void msetnx() {
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;//msetnx:&#21516;&#26102;&#35774;&#32622;&#19968;&#20010;&#25110;&#22810;&#20010;key-value&#23545;&#65292;&#24403;&#19988;&#20165;&#24403;key&#19981;&#23384;&#22312;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;long status = jedis.msetnx(&quot;foo&quot;, &quot;bar&quot;, &quot;bar&quot;, &quot;foo&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(1, status);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(&quot;bar&quot;, jedis.get(&quot;foo&quot;));
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(&quot;foo&quot;, jedis.get(&quot;bar&quot;));
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;status = jedis.msetnx(&quot;foo&quot;, &quot;bar1&quot;, &quot;bar2&quot;, &quot;foo2&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(0, status);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(&quot;bar&quot;, jedis.get(&quot;foo&quot;));
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(&quot;foo&quot;, jedis.get(&quot;bar&quot;));
    </p>
    <p>
      &#160;&#160;&#160;&#160;}
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;@Test(expected = JedisDataException.class)
    </p>
    <p>
      &#160;&#160;&#160;&#160;public void incrWrongValue() {
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;jedis.set(&quot;foo&quot;, &quot;bar&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//foo&#30340;&#20540;&#26159;&#23383;&#31526;&#20018;&#31867;&#22411;&#65292;&#25191;&#34892;incr&#20989;&#25968;&#21363;&#25243;&#20986;&#24322;&#24120;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;jedis.incr(&quot;foo&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;}
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;@Test
    </p>
    <p>
      &#160;&#160;&#160;&#160;public void incr() {
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;//&#22914;&#26524;foo&#19981;&#23384;&#22312;&#65292;&#20197;0&#20026;foo&#30340;&#21021;&#22987;&#20540;&#65292;&#28982;&#21518;&#25191;&#34892;INCR&#25805;&#20316;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;long value = jedis.incr(&quot;foo&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(1, value);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;value = jedis.incr(&quot;foo&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(2, value);
    </p>
    <p>
      &#160;&#160;&#160;&#160;}
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;@Test(expected = JedisDataException.class)
    </p>
    <p>
      &#160;&#160;&#160;&#160;public void incrByWrongValue() {
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;jedis.set(&quot;foo&quot;, &quot;bar&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//foo&#30340;&#20540;&#26159;&#23383;&#31526;&#20018;&#65292;&#32473;&#20182;&#22686;&#21152;2&#20928;&#25243;&#20986;&#24322;&#24120;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;jedis.incrBy(&quot;foo&quot;, 2);
    </p>
    <p>
      &#160;&#160;&#160;&#160;}
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;@Test
    </p>
    <p>
      &#160;&#160;&#160;&#160;public void incrBy() {
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;//&#22914;&#26524;foo&#19981;&#23384;&#22312;&#65292;&#20197;0&#20026;foo&#30340;&#21021;&#22987;&#20540;&#65292;&#28982;&#21518;&#25191;&#34892;INCRBY&#21629;&#20196;&#65292;&#22686;&#21152;2&#12290;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;long value = jedis.incrBy(&quot;foo&quot;, 2);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(2, value);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;value = jedis.incrBy(&quot;foo&quot;, 2);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(4, value);
    </p>
    <p>
      &#160;&#160;&#160;&#160;}
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;@Test(expected = JedisDataException.class)
    </p>
    <p>
      &#160;&#160;&#160;&#160;public void decrWrongValue() {
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;jedis.set(&quot;foo&quot;, &quot;bar&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//foo&#30340;&#20540;&#20026;&#23383;&#31526;&#20018;&#65292;&#19981;&#33021;&#25805;&#20316;&#20943;&#19968;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;jedis.decr(&quot;foo&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;}
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;@Test
    </p>
    <p>
      &#160;&#160;&#160;&#160;public void decr() {
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;//&#22914;&#26524;foo&#19981;&#23384;&#22312;&#65292;&#20197;0&#20026;foo&#30340;&#21021;&#22987;&#20540;&#65292;&#28982;&#21518;&#25191;&#34892;DECR&#25805;&#20316;&#12290;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;long value = jedis.decr(&quot;foo&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(-1, value);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;value = jedis.decr(&quot;foo&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(-2, value);
    </p>
    <p>
      &#160;&#160;&#160;&#160;}
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;@Test(expected = JedisDataException.class)
    </p>
    <p>
      &#160;&#160;&#160;&#160;public void decrByWrongValue() {
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;jedis.set(&quot;foo&quot;, &quot;bar&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//foo&#30340;&#20540;&#20026;&#23383;&#31526;&#20018;&#65292;&#19981;&#33021;&#25805;&#20316;&#20943;2
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;jedis.decrBy(&quot;foo&quot;, 2);
    </p>
    <p>
      &#160;&#160;&#160;&#160;}
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;@Test
    </p>
    <p>
      &#160;&#160;&#160;&#160;public void decrBy() {
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;long value = jedis.decrBy(&quot;foo&quot;, 2);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(-2, value);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;value = jedis.decrBy(&quot;foo&quot;, 2);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(-4, value);
    </p>
    <p>
      &#160;&#160;&#160;&#160;}
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;@Test
    </p>
    <p>
      &#160;&#160;&#160;&#160;public void append() {
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;//foo&#19981;&#23384;&#22312;&#65292;&#32473;foor&#30340;&#20540;&#35774;&#20026;bar&#65292;&#36820;&#22238;append&#21518;&#30340;&#20540;&#38271;&#24230;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;long value = jedis.append(&quot;foo&quot;, &quot;bar&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(3, value);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(&quot;bar&quot;, jedis.get(&quot;foo&quot;));
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//&#20877;&#27425;append,&#22312;&#20043;&#21069;&#30340;&#20540;&#20043;&#21518;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;value = jedis.append(&quot;foo&quot;, &quot;bar&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(6, value);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(&quot;barbar&quot;, jedis.get(&quot;foo&quot;));
    </p>
    <p>
      &#160;&#160;&#160;&#160;}
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;@Test
    </p>
    <p>
      &#160;&#160;&#160;&#160;public void substr() {
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;jedis.set(&quot;s&quot;, &quot;This is a string&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;//&#25130;&#23383;&#31526;&#20018;&#25805;&#20316;&#65292;&#27809;&#20160;&#20040;&#22909;&#35828;&#30340;
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(&quot;This&quot;, jedis.substr(&quot;s&quot;, 0, 3));
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(&quot;ing&quot;, jedis.substr(&quot;s&quot;, -3, -1));
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(&quot;This is a string&quot;, jedis.substr(&quot;s&quot;, 0, -1));
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(&quot; string&quot;, jedis.substr(&quot;s&quot;, 9, 100000));
    </p>
    <p>
      &#160;&#160;&#160;&#160;}
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;@Test
    </p>
    <p>
      &#160;&#160;&#160;&#160;public void strlen() {
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;jedis.set(&quot;s&quot;, &quot;This is a string&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(&quot;This is a string&quot;.length(), jedis.strlen(&quot;s&quot;).intValue());
    </p>
    <p>
      &#160;&#160;&#160;&#160;}
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;@Test
    </p>
    <p>
      &#160;&#160;&#160;&#160;public void incrLargeNumbers() {
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;long value = jedis.incr(&quot;foo&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(1, value);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(1L + Integer.MAX_VALUE, (long) jedis.incrBy(&quot;foo&quot;,
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Integer.MAX_VALUE));
    </p>
    <p>
      &#160;&#160;&#160;&#160;}
    </p>
    <p>
      
    </p>
    <p>
      &#160;&#160;&#160;&#160;@Test(expected = JedisDataException.class)
    </p>
    <p>
      &#160;&#160;&#160;&#160;public void incrReallyLargeNumbers() {
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;jedis.set(&quot;foo&quot;, Long.toString(Long.MAX_VALUE));
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;long value = jedis.incr(&quot;foo&quot;);
    </p>
    <p>
      &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;assertEquals(Long.MIN_VALUE, value);
    </p>
    <p>
      &#160;&#160;&#160;&#160;}
    </p>
    <p>
      }
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1473664223198" ID="ID_1290270550" MODIFIED="1473664260009" TEXT="Java&#x65b9;&#x6cd5;&#x7684;final&#x53c2;&#x6570;&#xff0c;&#x5bf9;&#x4e8e;&#x5f15;&#x7528;&#x7c7b;&#x578b;&#xff0c;&#x5c31;&#x662f;&#x4e0d;&#x80fd;&#x518d;&#x5728;&#x65b9;&#x6cd5;&#x5185;&#x90e8;&#x91cd;&#x65b0;new&#x5b9e;&#x4f8b;"/>
<node CREATED="1474332218368" ID="ID_1928482105" LINK="2016/09/jedis-8-invoke-method.mht" MODIFIED="1474332358983" TEXT="jedis&#x7684;&#x516b;&#x79cd;&#x8c03;&#x7528;&#x65b9;&#x5f0f;"/>
</node>
<node CREATED="1473819319799" FOLDED="true" ID="ID_23633334" MODIFIED="1475030152008" POSITION="right" TEXT="&#x538b;&#x6d4b;sql&#x8bed;&#x53e5;">
<node CREATED="1473819342506" ID="ID_1389751221" MODIFIED="1475030141821" TEXT="select ">
<node CREATED="1473819351428" ID="ID_1236876261" MODIFIED="1473819357409" TEXT="&#x7ebf;&#x4e0a;&#x7cfb;&#x7edf;">
<node CREATED="1473819475897" FOLDED="true" ID="ID_1912710726" MODIFIED="1475030144776" TEXT="1">
<node CREATED="1473819502868" ID="ID_865885868" MODIFIED="1473819520198">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      select order_id orderid, rebate_use_money isusedrate,pay_id paytype,pay_time timestamp,FROM_UNIXTIME(pay_time/1000,'%Y%m%d') date,ostype,&#160; FROM_UNIXTIME(pay_time/1000,'%H:%i:%s') opttime,order_status orderstatus,pay_status paystatus,refund_status refundstatus,&#160; bill_amount orderamount,jiesuan_amount+pay_fee receivedamount,is_check ischeck&#160;
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      from md_order_info&#160;
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      where&#160; pay_time&gt;=UNIX_TIMESTAMP(20160501)*1000
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      and pay_time&lt;UNIX_TIMESTAMP(20160601)*1000&#160;
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      and shop_id=@id
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      and ((refund_status = -1 and pay_status = 2) or (refund_status=2 and pay_status=2) or (pay_status=2 and order_status=5))
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      order by pay_time desc;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1473819524511" FOLDED="true" ID="ID_1719925529" MODIFIED="1475030145953" TEXT="2">
<node CREATED="1473819527574" ID="ID_1917529453" MODIFIED="1473819542464">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      select order_id orderid, rebate_use_money isusedrate,pay_id paytype,pay_time timestamp,FROM_UNIXTIME(pay_time/1000,'%Y%m%d') date,ostype,&#160; FROM_UNIXTIME(pay_time/1000,'%H:%i:%s') opttime,order_status orderstatus,pay_status paystatus,refund_status refundstatus,&#160; bill_amount orderamount,jiesuan_amount+pay_fee receivedamount,is_check ischeck&#160;
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      from md_order_info&#160;
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      where&#160; pay_time&gt;=UNIX_TIMESTAMP(20160501)*1000
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      and pay_time&lt;UNIX_TIMESTAMP(20160601)*1000&#160;
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      and shop_id=@id
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      and ((refund_status = -1 and pay_status = 2) or (refund_status=2 and pay_status=2) or (pay_status=2 and order_status=5))&#160;
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      and operator_id=@optid
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      order by pay_time desc;
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node CREATED="1473819358434" ID="ID_907533097" MODIFIED="1473819363979" TEXT="&#x90e8;&#x5206;&#x4fee;&#x6539;">
<node CREATED="1473819550389" FOLDED="true" ID="ID_51958310" MODIFIED="1475030147544" TEXT="1">
<node CREATED="1473819553941" ID="ID_991768437" MODIFIED="1473819569544">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      select order_id orderid, rebate_use_money isusedrate,pay_id paytype,pay_time timestamp,FROM_UNIXTIME(pay_time/1000,'%Y%m%d') date,ostype,&#160; FROM_UNIXTIME(pay_time/1000,'%H:%i:%s') opttime,order_status orderstatus,pay_status paystatus,refund_status refundstatus,&#160; bill_amount orderamount,jiesuan_amount+pay_fee receivedamount,is_check ischeck&#160;
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      from md_order_info&#160;
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      where&#160; order_id like 'Z1605%' and shop_id=@id
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      and ((refund_status = -1 and pay_status = 2) or (refund_status=2 and pay_status=2) or (pay_status=2 and order_status=5))
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      order by order_id&#160;desc;
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1473819573532" FOLDED="true" ID="ID_1737801288" MODIFIED="1475030148737" TEXT="2">
<node CREATED="1473819576519" ID="ID_1894217496" MODIFIED="1473819593430">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      select order_id orderid, rebate_use_money isusedrate,pay_id paytype,pay_time timestamp,FROM_UNIXTIME(pay_time/1000,'%Y%m%d') date,ostype,&#160; FROM_UNIXTIME(pay_time/1000,'%H:%i:%s') opttime,order_status orderstatus,pay_status paystatus,refund_status refundstatus,&#160; bill_amount orderamount,jiesuan_amount+pay_fee receivedamount,is_check ischeck&#160;
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      from md_order_info&#160;
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      where &#160;order_id like 'Z1605%' &#160;and shop_id=@id
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      and ((refund_status = -1 and pay_status = 2) or (refund_status=2 and pay_status=2) or (pay_status=2 and order_status=5))&#160;
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      and operator_id=@optid
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      order by order_id&#160;desc;
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
<node CREATED="1473819346722" ID="ID_1179696665" MODIFIED="1473819402598" TEXT="insert">
<node CREATED="1473819402600" FOLDED="true" ID="ID_407578353" MODIFIED="1475030137440" TEXT="&#x5199;&#x5165;md_order_info">
<node CREATED="1473819365991" ID="ID_1503855781" MODIFIED="1473819390881">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      insert into mdorder.md_order_info
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      (order_id,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      supplier_id,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      shop_id,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      shop_name,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      secret,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      order_channel,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      order_status,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      add_time,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      bind_limit_time,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      remark,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      user_id,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      mobile,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      mid,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      ostype,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      bind_time,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      bill_amount,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      surplus,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      rebate_use_money,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      money_paid,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      order_amount,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      order_off_money,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      no_rebate_money,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      pay_status,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      pay_limit_time,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      pay_id,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      pay_name,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      pay_time,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      pay_sync,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      trade_pay_account,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      trade_no,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      third_trade_no,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      confirm_time,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      refund_time,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      refund_status,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      is_refunded,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      schema_id,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      schema_name,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      contract_id,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      rebate_rate,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      settlement_rate,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      rebate_status,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      order_rebate_money,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      order_rebate_total_money,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      operator_id,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      operator_name,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      operator_mid,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      order_source,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      order_user_hide,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      order_shop_hide,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      last_update_time,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      route_time,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      extend_filed1,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      extend_filed2,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      extend_filed3,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      extend_filed4,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      extend_filed5,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      city_id,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      rebate_time,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      first_trade_rebate_money,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      is_check,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      pay_fee,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      jiesuan_amount,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      out_order_id
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      )
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      values
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      ('Z16091399996',
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      8009371,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      8015487,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      '50&#23706;&#40092;&#33590;&#19987;&#21334;&#36830;&#38145;(&#29790;&#37329;&#19968;&#36335;&#24215;)',
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      '20181388',
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      2,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      5,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      1473741576550,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      1473742476550,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-size: 11.0pt">
      <font face="Calibri">'</font><font face="Microsoft YaHei">&#21387;&#27979;&#19987;&#29992;</font><font face="Calibri">', </font>
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      106071300,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      '',
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      '2088902377800046',
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      106,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      1473741576568,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0.01,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0.00,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0.00,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0.01,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0.00,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0.00,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0.00,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      2,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      1473748776568,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      10,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-size: 11.0pt">
      <font face="Calibri">'</font><font face="Microsoft YaHei">&#25903;&#20184;&#23453;&#26381;&#21153;&#31383;&#25903;&#20184;</font><font face="Calibri">', </font>
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      1473741582543,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      '280762115@qq.com',
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      'Z160913999960000',
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      '2016091321001004040241469047',
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      41431,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      '%0',
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      5041977,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0.00,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0.0000,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0.00,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0.00,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      '',
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      '',
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      '106',
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      1473741583887,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      20160913,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      2,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0.00,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0.00,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0.01,
    </p>
    <p lang="en-US" style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      NULL
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      );
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1473819425870" FOLDED="true" ID="ID_1258751046" MODIFIED="1475030139991" TEXT="&#x5199;&#x5165;md_order_action">
<node CREATED="1473819453885" ID="ID_965390397" MODIFIED="1473819461387">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: 0in; font-family: Calibri; font-size: 11.0pt">
      insert into mdorder.md_order_action
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      (id,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      order_id,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      shop_id,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      action_user,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      action_place,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      action_note,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      system_note,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      log_time,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      action_from,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      old_info,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      new_info,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      action_type,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      ip,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      opt_mid,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      pid,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      route_time
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      )
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      values
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      (1473741576568132000,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      'Z16091399996',
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      8015487,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      '106071300',
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      1,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      '&#29992;&#25143;&#35746;&#21333;&#32465;&#23450;',
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      '&#29992;&#25143;&#35746;&#21333;&#32465;&#23450;',
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      1473741576568,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      1,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      '',
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      'userId:Z16091399996,mobile:,mid:2088902377800046,ostype:106',
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      0,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      '116.213.178.6',
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      'Z16091399996',
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      NULL,
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      20160913
    </p>
    <p style="margin-top: 0in; margin-right: 0in; margin-bottom: 0in; margin-left: .375in; font-family: Calibri; font-size: 11.0pt">
      );
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
</node>
<node CREATED="1473649150839" FOLDED="true" ID="ID_292738889" MODIFIED="1475030314224" POSITION="left">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#20027;&#31449;&#24182;&#21457;&#38145;&#26426;&#21046;
    </p>
    <p>
      
    </p>
    <p>
      &#22522;&#20110;redis
    </p>
  </body>
</html></richcontent>
<node CREATED="1473649191071" ID="ID_427966017" MODIFIED="1475029831483" TEXT="&#x5e94;&#x7528;&#x573a;&#x666f;">
<node CREATED="1473649373014" ID="ID_854254399" MODIFIED="1473649540923">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#25353;&#23581;&#35797;&#27425;&#25968;<font color="#0033cc">&#21462;&#38145;</font>
    </p>
  </body>
</html></richcontent>
<node CREATED="1473649196876" ID="ID_1378498456" MODIFIED="1473649656945">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <b><font color="#660066">DLock</font></b>&#160;dLock;
    </p>
    <p>
      long lockTime = 60*1000;
    </p>
    <p>
      int lockTryTimes =1; //&#21482;&#23581;&#35797;&#21462;&#19968;&#27425;&#38145;
    </p>
    <p>
      <font color="#009933">LockResult&lt;?&gt;</font>&#160;lockResult =<font color="#660066">dLock</font>.<font color="#0033cc">lockManualByTimes</font>(<font color="#990099">distributeKey</font>,lockTime,lockTryTimes);
    </p>
    <p>
      
    </p>
    <p>
      if(<font color="#009933">lockResult</font>.<font color="#006666">getCode() </font>!= 0){//&#21462;&#38145;&#22833;&#36133;&#65281;}
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1473649504128" ID="ID_198560107" MODIFIED="1473649581951">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      <font color="#009933">&#35299;&#38145;</font>&#65292;&#19968;&#33324;&#24517;&#22312;try/catch/finally&#30340;<font color="#ff3300">finally&#22359;</font>&#20013;
    </p>
  </body>
</html></richcontent>
<node CREATED="1473649577966" ID="ID_1547846446" MODIFIED="1473649644688">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      if(lockResult!=null &amp;&amp; lockResult.getCode ==0)
    </p>
    <p>
      &#160;&#160;&#160;dLock.<font color="#cc0000">unlockManual</font>(<font color="#990099">distributerKey</font>)
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node CREATED="1473650039612" ID="ID_999571497" MODIFIED="1473673444250" TEXT="cozy-common-lock-redis.jar">
<node CREATED="1473650182377" FOLDED="true" ID="ID_1563670027" MODIFIED="1475030255343" TEXT="interface">
<node CREATED="1473650190720" ID="ID_1453584469" MODIFIED="1473650194138" TEXT="DLock"/>
<node CREATED="1473650494413" ID="ID_424867507" MODIFIED="1473650508595" TEXT="ConnectionFactory">
<node CREATED="1473650571031" ID="ID_905801232" MODIFIED="1473650578242" TEXT="makeLockCache"/>
<node CREATED="1473650580132" ID="ID_1596311304" MODIFIED="1473650598573" TEXT="makeLockCache(PoolInfoBean)">
<node CREATED="1473662578658" ID="ID_1032333150" MODIFIED="1475029831489" TEXT="PoolInfoBean">
<node CREATED="1473662599090" ID="ID_829566831" MODIFIED="1473662611159" TEXT="host: ip or &#x57df;&#x540d;"/>
<node CREATED="1473662612840" ID="ID_1187602838" MODIFIED="1473662624646" TEXT="port: &#x7aef;&#x53e3;"/>
<node CREATED="1473662627414" ID="ID_283466111" MODIFIED="1473662653800" TEXT="url:&#x6c60;&#x5b50;&#x6807;&#x8bc6; = host+port"/>
<node CREATED="1473662658483" ID="ID_1953891214" MODIFIED="1473662663272" TEXT="isCanUsed"/>
</node>
</node>
<node CREATED="1473650603984" ID="ID_522118375" MODIFIED="1473650621673" TEXT="isAvailable(PoolInfoBean)"/>
</node>
</node>
<node CREATED="1473650196082" FOLDED="true" ID="ID_1609072683" MODIFIED="1475030270663" TEXT="implement">
<node CREATED="1473650224188" ID="ID_94512994" MODIFIED="1473650230845" TEXT="DLockImpl"/>
<node CREATED="1473650511516" ID="ID_1885791459" MODIFIED="1473650523123" TEXT="RedisConnectionFactory">
<node CREATED="1473662745827" ID="ID_726515104" MODIFIED="1473662752943" TEXT="makeLockCache">
<node CREATED="1473662754470" ID="ID_1992131929" MODIFIED="1473662797204">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      1&#12289;Jedis jedis = getConnection();
    </p>
  </body>
</html></richcontent>
<node CREATED="1473662835423" ID="ID_436004385" MODIFIED="1475029831498" TEXT="FailOver&#x6545;&#x969c;&#x81ea;&#x52a8;&#x5207;&#x6362;&#x7b56;&#x7565;&#x5de5;&#x5177;">
<node CREATED="1473663106742" ID="ID_703918514" MODIFIED="1473663150447" TEXT="isFailOver&#x4ee3;&#x8868;&#x662f;&#x5426;&#x652f;&#x6301;FailOver&#xff0c;&#x5373;&#x65e0;&#x6545;&#x969c;&#x5207;&#x6362;"/>
<node CREATED="1473663163642" ID="ID_1425107448" MODIFIED="1473663205703" TEXT="List&lt;PoolInfoBean&gt; poolStatusList,&#x8fde;&#x63a5;&#x6c60;&#x72b6;&#x6001;&#x5217;&#x8868;"/>
<node CREATED="1473663217317" ID="ID_147913593" MODIFIED="1473663221752" TEXT="poolSize"/>
<node CREATED="1473663222626" ID="ID_1333595643" MODIFIED="1473663247055" TEXT="primaryIndex,&#x5f53;&#x524d;&#x4e3b;&#x6c60;&#x5b50;"/>
<node CREATED="1473663557973" ID="ID_1027370218" MODIFIED="1473663609372">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      &#30446;&#30340;&#65306;&#19968;&#20010;&#31616;&#21333;&#30340;&#31649;&#29702;PoolInfoBean&#30340;&#31867;
    </p>
    <p>
      
    </p>
    <p>
      &#29992;&#20110;&#26816;&#32034;&#12289;&#35774;&#32622;&#12289;&#26597;&#35810;&#26377;&#25928;&#30340;PoolInfoBean&#32780;&#24050;&#12290;
    </p>
  </body>
</html></richcontent>
</node>
</node>
</node>
<node CREATED="1473662763797" ID="ID_1503411180" MODIFIED="1473662782414" TEXT="2&#x3001;new RedisLockCache(jedis,this)"/>
</node>
<node BACKGROUND_COLOR="#ffff99" CREATED="1473673451075" ID="ID_452242232" MODIFIED="1473673476068" TEXT="initialPool&#x5f88;&#x5173;&#x952e;">
<node CREATED="1473673478902" ID="ID_828990800" MODIFIED="1473673494788" TEXT="&#x521d;&#x59cb;&#x5316;&#x8fde;&#x63a5;&#x5230;redis&#x7684;&#x6c60;"/>
</node>
</node>
</node>
<node CREATED="1473650689895" ID="ID_1931263681" MODIFIED="1473650692643" TEXT="other">
<node CREATED="1473650273246" FOLDED="true" ID="ID_1028595152" MODIFIED="1475030302959" TEXT="LockResult">
<node CREATED="1473650291730" ID="ID_1364349760" MODIFIED="1473650425246">
<richcontent TYPE="NODE"><html>
  <head>
    
  </head>
  <body>
    <p>
      import java.io.Serializable;
    </p>
    <p>
      
    </p>
    <p>
      public class LockResult &lt;T&gt; implements Serializable{
    </p>
    <p>
      private static final long serialVersionUID = -7891440771293974054L;
    </p>
    <p>
      <b><font color="#006600">/*</font><font color="#0033cc">0,&#25104;&#21151;</font><font color="#006600">&#65307;&#20854;&#23427;&#24453;&#23450;*/</font></b>
    </p>
    <p>
      public int <font color="#0033cc">code</font>;
    </p>
    <p>
      /** &#25551;&#36848;&#160;&#160;*/
    </p>
    <p>
      public String description;
    </p>
    <p>
      /** &#19994;&#21153;&#36820;&#22238;&#23545;&#35937;&#160;&#160;*/
    </p>
    <p>
      <font color="#0033cc">public T result;</font>
    </p>
    <p>
      
    </p>
    <p>
      public LockResult(int code,String description,T result){
    </p>
    <p>
      super();
    </p>
    <p>
      this.code = code;
    </p>
    <p>
      this.description = description;
    </p>
    <p>
      this.result = result;
    </p>
    <p>
      }
    </p>
    <p>
      
    </p>
    <p>
      public int getCode() {
    </p>
    <p>
      return code;
    </p>
    <p>
      }
    </p>
    <p>
      public void setCode(int code) {
    </p>
    <p>
      this.code = code;
    </p>
    <p>
      }
    </p>
    <p>
      public String getDescription() {
    </p>
    <p>
      return description;
    </p>
    <p>
      }
    </p>
    <p>
      public void setDescription(String description) {
    </p>
    <p>
      this.description = description;
    </p>
    <p>
      }
    </p>
    <p>
      public<b>&#160;<font color="#006600">T</font></b>&#160;<font color="#0033cc">getResult</font>() {
    </p>
    <p>
      return result;
    </p>
    <p>
      }
    </p>
    <p>
      public void <font color="#0033cc">setResult</font>(<b><font color="#006600">T</font></b>&#160;result) {
    </p>
    <p>
      this.result = result;
    </p>
    <p>
      }
    </p>
    <p>
      }
    </p>
  </body>
</html></richcontent>
</node>
</node>
<node CREATED="1473650697365" ID="ID_761976244" MODIFIED="1473650706380" TEXT="RedisDlockConfig"/>
</node>
</node>
<node BACKGROUND_COLOR="#ccffcc" CREATED="1473673257411" ID="ID_1375454175" MODIFIED="1473673534861" TEXT="&#x8be5;&#x9501;&#x673a;&#x5236;&#x7684;redis&#x914d;&#x7f6e;&#x5199;&#x6b7b;&#x5728;&#x4ee3;&#x7801;&#x91cc;&#x4e86;&#xff0c;shit!">
<node BACKGROUND_COLOR="#99ff99" CREATED="1473673278917" ID="ID_1448612529" MODIFIED="1473673527301" TEXT="redis.55tuan.me:7380?timeout=30*1000"/>
<node CREATED="1473673315204" ID="ID_279898971" MODIFIED="1473673327827" TEXT="in AbstractDlockConfig"/>
<node BACKGROUND_COLOR="#ff99cc" CREATED="1473674688940" ID="ID_90315083" MODIFIED="1473674735652" TEXT="&#x6211;&#x5f04;&#x9519;&#x4e86;&#xff0c;&#x5728;mdpaygate-cache-impl-bean.xml&#x4e2d;&#x6709;&#x5355;&#x72ec;&#x914d;&#x7f6e;&#x51fa;&#x6765;&#x7684;dlockConfig"/>
</node>
</node>
</node>
</map>
